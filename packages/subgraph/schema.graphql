# Enums
enum State {
  RUNNING
  STOPPED
  HALTED
  EXECUTED
}

enum VoterState {
  Absent
  Yea
  Nay
}

# Types

# Processes
type Action @entity {
  id: ID!
  to: Bytes! # Address to call.
  value: BigInt! # Value to be sent with the call. for example (ETH)
  data: Bytes!
  proposal: Proposal!
  execution: Execution!
  execResult: Bytes
}

type Proposal @entity {
  id: ID!
  dao: Dao!
  process: Process!
  metadata: Bytes!
  additionalArguments: Bytes
  actions: [Action!]! @derivedFrom(field: "proposal")
}

type AllowedAction @entity {
  id: ID!
  allowedAction: Bytes!
  process: Process!
  isRemoved: Boolean!
}

type Process @entity {
  id: ID!
  dao: Dao!
  address: Bytes!
  isActive: Boolean!
  allowedActions: [AllowedAction!]! @derivedFrom(field: "process")
  proposals: [Proposal!]! @derivedFrom(field: "process")
}

type Execution @entity {
  id: ID!
  dao: Dao!
  executionId: BigInt!
  proposal: Proposal!
  state: State!
}

# Voting (simple voting)
# type Voter @entity {
#   id: ID!
#   voter: Bytes!
#   state: VoterState!
# }

# type Vote @entity {
#   id: ID!
#   voteId: BigInt!
#   description: String!
#   creator: Bytes! # address
#   executed: Boolean!
#   startDate: BigInt!
#   snapshotBlock: BigInt!
#   supportRequiredPct: BigInt!
#   minAcceptQuorumPct: BigInt!
#   yea: BigInt!
#   nay: BigInt!
#   votingPower: BigInt!
#   voters: [Voter!]
# }

# Vault
type VaultWithdraw @entity {
  id: ID!
  dao: Dao!
  token: Bytes
  to: Bytes!
  amount: BigInt!
  reason: String!
}

type VaultEthDeposit @entity {
  id: ID!
  dao: Dao!
  sender: Bytes!
  amount: BigInt!
}

type VaultDeposit @entity {
  id: ID!
  dao: Dao!
  token: Bytes!
  sender: Bytes!
  amount: BigInt!
  reason: String!
}

# Daos
type Dao @entity {
  id: ID!
  name: String!
  daoAddress: Bytes!
  creator: Bytes!
  metadata: String!
  token: Bytes!
  processes: [Process!]! @derivedFrom(field: "dao")
  proposals: [Proposal!]! @derivedFrom(field: "dao")
  ethDeposits: [VaultEthDeposit!]! @derivedFrom(field: "dao")
  tokenDeposits: [VaultDeposit!]! @derivedFrom(field: "dao")
  withdraws: [VaultWithdraw!]! @derivedFrom(field: "dao")
  executions: [Execution!]! @derivedFrom(field: "dao")
}
