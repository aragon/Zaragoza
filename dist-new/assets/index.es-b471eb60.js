import{cO as pc,fB as _v,dc as fc,cW as yv,fC as Sr,cR as tt,fD as pt,fE as qe,fF as Oi,fG as wv,de as Xt,fH as Iv,fI as Ev,fJ as bv,fK as rs,fL as tr,fM as Bt,cQ as T,fN as Cr,fO as Pv,fP as Sv,fQ as is,fR as Zo,fS as Rr,fT as Cv,fU as Rv,fV as Nv,fW as Xo,fX as Av,fY as Ov,cU as Dv,fZ as qv,f_ as xv,f$ as $v,g0 as jv,g1 as Tv,g2 as Dr,g3 as Di,g4 as dc,g5 as ns,g6 as Mv,g7 as Vv}from"./main-1e616d6f.js";import{d as Uv,c as er,S as kv,f as Lv,r as zv,g as Ci,w as Fv,N as gs}from"./index.es-c80844a1.js";import{i as xe,a as $e,h as Hv,f as Gv,b as Wv,c as Bv,d as Kv,e as Jv,J as je}from"./browser-9096de8d.js";import{H as Te}from"./http-efa116e8.js";import"./tiptap-313d156f.js";import"./osx-ethers-780b73f3.js";const gc="wc",vc=2,mc="client",vs=`${gc}@${vc}:${mc}:`,ss={name:mc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Yv="WALLETCONNECT_DEEPLINK_CHOICE",Qv="proposal",_c="Proposal expired",Zv="session",Ri=tt.SEVEN_DAYS,Xv="engine",Nr={wc_sessionPropose:{req:{ttl:tt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:tt.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:tt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:tt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:tt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:tt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:tt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:tt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:tt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:tt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:tt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:tt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:tt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:tt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:tt.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:tt.THIRTY_SECONDS,prompt:!1,tag:1115}}},as={min:tt.FIVE_MINUTES,max:tt.SEVEN_DAYS},t0="request",e0=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var r0=Object.defineProperty,i0=Object.defineProperties,n0=Object.getOwnPropertyDescriptors,tc=Object.getOwnPropertySymbols,s0=Object.prototype.hasOwnProperty,a0=Object.prototype.propertyIsEnumerable,ec=(E,s,i)=>s in E?r0(E,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):E[s]=i,Ut=(E,s)=>{for(var i in s||(s={}))s0.call(s,i)&&ec(E,i,s[i]);if(tc)for(var i of tc(s))a0.call(s,i)&&ec(E,i,s[i]);return E},os=(E,s)=>i0(E,n0(s));class o0 extends Lv{constructor(s){super(s),this.name=Xv,this.events=new fc,this.initialized=!1,this.ignoredPayloadTypes=[yv],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Nr)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const a=os(Ut({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(a);const{pairingTopic:h,requiredNamespaces:g,optionalNamespaces:w,sessionProperties:b,relays:S}=a;let N=h,F,Y=!1;if(N&&(Y=this.client.core.pairing.pairings.get(N).active),!N||!Y){const{topic:ut,uri:ot}=await this.client.core.pairing.create();N=ut,F=ot}const G=await this.client.core.crypto.generateKeyPair(),Q=Ut({requiredNamespaces:g,optionalNamespaces:w,relays:S??[{protocol:zv}],proposer:{publicKey:G,metadata:this.client.metadata}},b&&{sessionProperties:b}),{reject:nt,resolve:Kt,done:ft}=Sr(tt.FIVE_MINUTES,_c);if(this.events.once(pt("session_connect"),async({error:ut,session:ot})=>{if(ut)nt(ut);else if(ot){ot.self.publicKey=G;const bt=os(Ut({},ot),{requiredNamespaces:ot.requiredNamespaces,optionalNamespaces:ot.optionalNamespaces});await this.client.session.set(ot.topic,bt),await this.setExpiry(ot.topic,ot.expiry),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:ot.peer.metadata}),Kt(bt)}}),!N){const{message:ut}=T("NO_MATCHING_KEY",`connect() pairing topic: ${N}`);throw new Error(ut)}const Ot=await this.sendRequest(N,"wc_sessionPropose",Q),qr=qe(tt.FIVE_MINUTES);return await this.setProposal(Ot,Ut({id:Ot,expiry:qr},Q)),{uri:F,approval:ft}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:a,relayProtocol:h,namespaces:g,sessionProperties:w}=i,b=this.client.proposal.get(a);let{pairingTopic:S,proposer:N,requiredNamespaces:F,optionalNamespaces:Y}=b;S=S||"",Oi(F)||(F=wv(g,"approve()"));const G=await this.client.core.crypto.generateKeyPair(),Q=N.publicKey,nt=await this.client.core.crypto.generateSharedKey(G,Q);S&&a&&(await this.client.core.pairing.updateMetadata({topic:S,metadata:N.metadata}),await this.sendResult(a,S,{relay:{protocol:h??"irn"},responderPublicKey:G}),await this.client.proposal.delete(a,Xt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:S}));const Kt=Ut({relay:{protocol:h??"irn"},namespaces:g,requiredNamespaces:F,optionalNamespaces:Y,pairingTopic:S,controller:{publicKey:G,metadata:this.client.metadata},expiry:qe(Ri)},w&&{sessionProperties:w});await this.client.core.relayer.subscribe(nt),await this.sendRequest(nt,"wc_sessionSettle",Kt);const ft=os(Ut({},Kt),{topic:nt,pairingTopic:S,acknowledged:!1,self:Kt.controller,peer:{publicKey:N.publicKey,metadata:N.metadata},controller:G});return await this.client.session.set(nt,ft),await this.setExpiry(nt,qe(Ri)),{topic:nt,acknowledged:()=>new Promise(Ot=>setTimeout(()=>Ot(this.client.session.get(nt)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:a,reason:h}=i,{pairingTopic:g}=this.client.proposal.get(a);g&&(await this.sendError(a,g,h),await this.client.proposal.delete(a,Xt("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:a,namespaces:h}=i,g=await this.sendRequest(a,"wc_sessionUpdate",{namespaces:h}),{done:w,resolve:b,reject:S}=Sr();return this.events.once(pt("session_update",g),({error:N})=>{N?S(N):b()}),await this.client.session.update(a,{namespaces:h}),{acknowledged:w}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:a}=i,h=await this.sendRequest(a,"wc_sessionExtend",{}),{done:g,resolve:w,reject:b}=Sr();return this.events.once(pt("session_extend",h),({error:S})=>{S?b(S):w()}),await this.setExpiry(a,qe(Ri)),{acknowledged:g}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:a,request:h,topic:g,expiry:w}=i,b=await this.sendRequest(g,"wc_sessionRequest",{request:h,chainId:a},w),{done:S,resolve:N,reject:F}=Sr(w);this.events.once(pt("session_request",b),({error:G,result:Q})=>{G?F(G):N(Q)}),this.client.events.emit("session_request_sent",{topic:g,request:h,chainId:a,id:b});const Y=await this.client.core.storage.getItem(Yv);return Iv({id:b,topic:g,wcDeepLink:Y}),await S()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:a,response:h}=i,{id:g}=h;xe(h)?await this.sendResult(g,a,h.result):$e(h)&&await this.sendError(g,a,h.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:a}=i;if(this.client.session.keys.includes(a)){const h=await this.sendRequest(a,"wc_sessionPing",{}),{done:g,resolve:w,reject:b}=Sr();this.events.once(pt("session_ping",h),({error:S})=>{S?b(S):w()}),await g()}else this.client.core.pairing.pairings.keys.includes(a)&&await this.client.core.pairing.ping({topic:a})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:a,event:h,chainId:g}=i;await this.sendRequest(a,"wc_sessionEvent",{event:h,chainId:g})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:a}=i;if(this.client.session.keys.includes(a)){const h=Hv().toString();let g;const w=b=>{b?.id.toString()===h&&(this.client.core.relayer.events.removeListener(Ci.message_ack,w),g())};await Promise.all([new Promise(b=>{g=b,this.client.core.relayer.on(Ci.message_ack,w)}),this.sendRequest(a,"wc_sessionDelete",Xt("USER_DISCONNECTED"),void 0,h)]),await this.deleteSession(a)}else await this.client.core.pairing.disconnect({topic:a})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(a=>Ev(a,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const a=this.client.core.pairing.pairings.get(i.pairingTopic),h=this.client.core.pairing.pairings.getAll().filter(g=>{var w,b;return((w=g.peerMetadata)==null?void 0:w.url)&&((b=g.peerMetadata)==null?void 0:b.url)===i.peer.metadata.url&&g.topic&&g.topic!==a.topic});if(h.length===0)return;this.client.logger.info(`Cleaning up ${h.length} duplicate pairing(s)`),await Promise.all(h.map(g=>this.client.core.pairing.disconnect({topic:g.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(a){this.client.logger.error(a)}},this.deleteSession=async(i,a)=>{const{self:h}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,Xt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(h.publicKey)&&await this.client.core.crypto.deleteKeyPair(h.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),a||this.client.core.expirer.del(i)},this.deleteProposal=async(i,a)=>{await Promise.all([this.client.proposal.delete(i,Xt("USER_DISCONNECTED")),a?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,a,h=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,a),h?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,a)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:a}),this.client.core.expirer.set(i,a)},this.setProposal=async(i,a)=>{await this.client.proposal.set(i,a),this.client.core.expirer.set(i,a.expiry)},this.setPendingSessionRequest=async i=>{const a=Nr.wc_sessionRequest.req.ttl,{id:h,topic:g,params:w}=i;await this.client.pendingRequest.set(h,{id:h,topic:g,params:w}),a&&this.client.core.expirer.set(h,qe(a))},this.sendRequest=async(i,a,h,g,w)=>{const b=Kv(a,h);if(bv()&&e0.includes(a)){const F=rs(JSON.stringify(b));await this.client.core.verify.register({attestationId:F})}const S=await this.client.core.crypto.encode(i,b),N=Nr[a].req;return g&&(N.ttl=g),w&&(N.id=w),this.client.core.history.set(i,b),this.client.core.relayer.publish(i,S,N),b.id},this.sendResult=async(i,a,h)=>{const g=Jv(i,h),w=await this.client.core.crypto.encode(a,g),b=await this.client.core.history.get(a,i),S=Nr[b.request.method].res;this.client.core.relayer.publish(a,w,S),await this.client.core.history.resolve(g)},this.sendError=async(i,a,h)=>{const g=Gv(i,h),w=await this.client.core.crypto.encode(a,g),b=await this.client.core.history.get(a,i),S=Nr[b.request.method].res;this.client.core.relayer.publish(a,w,S),await this.client.core.history.resolve(g)},this.cleanup=async()=>{const i=[],a=[];this.client.session.getAll().forEach(h=>{tr(h.expiry)&&i.push(h.topic)}),this.client.proposal.getAll().forEach(h=>{tr(h.expiry)&&a.push(h.id)}),await Promise.all([...i.map(h=>this.deleteSession(h)),...a.map(h=>this.deleteProposal(h))])},this.onRelayEventRequest=i=>{const{topic:a,payload:h}=i,g=h.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeRequest(a,h);case"wc_sessionSettle":return this.onSessionSettleRequest(a,h);case"wc_sessionUpdate":return this.onSessionUpdateRequest(a,h);case"wc_sessionExtend":return this.onSessionExtendRequest(a,h);case"wc_sessionPing":return this.onSessionPingRequest(a,h);case"wc_sessionDelete":return this.onSessionDeleteRequest(a,h);case"wc_sessionRequest":return this.onSessionRequest(a,h);case"wc_sessionEvent":return this.onSessionEventRequest(a,h);default:return this.client.logger.info(`Unsupported request method ${g}`)}},this.onRelayEventResponse=async i=>{const{topic:a,payload:h}=i,g=(await this.client.core.history.get(a,h.id)).request.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeResponse(a,h);case"wc_sessionSettle":return this.onSessionSettleResponse(a,h);case"wc_sessionUpdate":return this.onSessionUpdateResponse(a,h);case"wc_sessionExtend":return this.onSessionExtendResponse(a,h);case"wc_sessionPing":return this.onSessionPingResponse(a,h);case"wc_sessionRequest":return this.onSessionRequestResponse(a,h);default:return this.client.logger.info(`Unsupported response method ${g}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:a}=i,{message:h}=T("MISSING_OR_INVALID",`Decoded payload on topic ${a} is not identifiable as a JSON-RPC request or a response.`);throw new Error(h)},this.onSessionProposeRequest=async(i,a)=>{const{params:h,id:g}=a;try{this.isValidConnect(Ut({},a.params));const w=qe(tt.FIVE_MINUTES),b=Ut({id:g,pairingTopic:i,expiry:w},h);await this.setProposal(g,b);const S=rs(JSON.stringify(a)),N=await this.getVerifyContext(S,b.proposer.metadata);this.client.events.emit("session_proposal",{id:g,params:b,verifyContext:N})}catch(w){await this.sendError(g,i,w),this.client.logger.error(w)}},this.onSessionProposeResponse=async(i,a)=>{const{id:h}=a;if(xe(a)){const{result:g}=a;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:g});const w=this.client.proposal.get(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:w});const b=w.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:b});const S=g.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:S});const N=await this.client.core.crypto.generateSharedKey(b,S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:N});const F=await this.client.core.relayer.subscribe(N);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:F}),await this.client.core.pairing.activate({topic:i})}else $e(a)&&(await this.client.proposal.delete(h,Xt("USER_DISCONNECTED")),this.events.emit(pt("session_connect"),{error:a.error}))},this.onSessionSettleRequest=async(i,a)=>{const{id:h,params:g}=a;try{this.isValidSessionSettleRequest(g);const{relay:w,controller:b,expiry:S,namespaces:N,requiredNamespaces:F,optionalNamespaces:Y,sessionProperties:G,pairingTopic:Q}=a.params,nt=Ut({topic:i,relay:w,expiry:S,namespaces:N,acknowledged:!0,pairingTopic:Q,requiredNamespaces:F,optionalNamespaces:Y,controller:b.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:b.publicKey,metadata:b.metadata}},G&&{sessionProperties:G});await this.sendResult(a.id,i,!0),this.events.emit(pt("session_connect"),{session:nt}),this.cleanupDuplicatePairings(nt)}catch(w){await this.sendError(h,i,w),this.client.logger.error(w)}},this.onSessionSettleResponse=async(i,a)=>{const{id:h}=a;xe(a)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(pt("session_approve",h),{})):$e(a)&&(await this.client.session.delete(i,Xt("USER_DISCONNECTED")),this.events.emit(pt("session_approve",h),{error:a.error}))},this.onSessionUpdateRequest=async(i,a)=>{const{params:h,id:g}=a;try{this.isValidUpdate(Ut({topic:i},h)),await this.client.session.update(i,{namespaces:h.namespaces}),await this.sendResult(g,i,!0),this.client.events.emit("session_update",{id:g,topic:i,params:h})}catch(w){await this.sendError(g,i,w),this.client.logger.error(w)}},this.onSessionUpdateResponse=(i,a)=>{const{id:h}=a;xe(a)?this.events.emit(pt("session_update",h),{}):$e(a)&&this.events.emit(pt("session_update",h),{error:a.error})},this.onSessionExtendRequest=async(i,a)=>{const{id:h}=a;try{this.isValidExtend({topic:i}),await this.setExpiry(i,qe(Ri)),await this.sendResult(h,i,!0),this.client.events.emit("session_extend",{id:h,topic:i})}catch(g){await this.sendError(h,i,g),this.client.logger.error(g)}},this.onSessionExtendResponse=(i,a)=>{const{id:h}=a;xe(a)?this.events.emit(pt("session_extend",h),{}):$e(a)&&this.events.emit(pt("session_extend",h),{error:a.error})},this.onSessionPingRequest=async(i,a)=>{const{id:h}=a;try{this.isValidPing({topic:i}),await this.sendResult(h,i,!0),this.client.events.emit("session_ping",{id:h,topic:i})}catch(g){await this.sendError(h,i,g),this.client.logger.error(g)}},this.onSessionPingResponse=(i,a)=>{const{id:h}=a;setTimeout(()=>{xe(a)?this.events.emit(pt("session_ping",h),{}):$e(a)&&this.events.emit(pt("session_ping",h),{error:a.error})},500)},this.onSessionDeleteRequest=async(i,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:i,reason:a.params}),await Promise.all([new Promise(g=>{this.client.core.relayer.once(Ci.publish,async()=>{g(await this.deleteSession(i))})}),this.sendResult(h,i,!0)]),this.client.events.emit("session_delete",{id:h,topic:i})}catch(g){this.client.logger.error(g)}},this.onSessionRequest=async(i,a)=>{const{id:h,params:g}=a;try{this.isValidRequest(Ut({topic:i},g)),await this.setPendingSessionRequest({id:h,topic:i,params:g});const w=rs(JSON.stringify(a)),b=this.client.session.get(i),S=await this.getVerifyContext(w,b.peer.metadata);this.client.events.emit("session_request",{id:h,topic:i,params:g,verifyContext:S})}catch(w){await this.sendError(h,i,w),this.client.logger.error(w)}},this.onSessionRequestResponse=(i,a)=>{const{id:h}=a;xe(a)?this.events.emit(pt("session_request",h),{result:a.result}):$e(a)&&this.events.emit(pt("session_request",h),{error:a.error})},this.onSessionEventRequest=async(i,a)=>{const{id:h,params:g}=a;try{this.isValidEmit(Ut({topic:i},g)),this.client.events.emit("session_event",{id:h,topic:i,params:g})}catch(w){await this.sendError(h,i,w),this.client.logger.error(w)}},this.isValidConnect=async i=>{if(!Bt(i)){const{message:S}=T("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(S)}const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:g,sessionProperties:w,relays:b}=i;if(Cr(a)||await this.isValidPairingTopic(a),!Pv(b,!0)){const{message:S}=T("MISSING_OR_INVALID",`connect() relays: ${b}`);throw new Error(S)}!Cr(h)&&Oi(h)!==0&&this.validateNamespaces(h,"requiredNamespaces"),!Cr(g)&&Oi(g)!==0&&this.validateNamespaces(g,"optionalNamespaces"),Cr(w)||this.validateSessionProps(w,"sessionProperties")},this.validateNamespaces=(i,a)=>{const h=Sv(i,"connect()",a);if(h)throw new Error(h.message)},this.isValidApprove=async i=>{if(!Bt(i))throw new Error(T("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:a,namespaces:h,relayProtocol:g,sessionProperties:w}=i;await this.isValidProposalId(a);const b=this.client.proposal.get(a),S=is(h,"approve()");if(S)throw new Error(S.message);const N=Zo(b.requiredNamespaces,h,"approve()");if(N)throw new Error(N.message);if(!Rr(g,!0)){const{message:F}=T("MISSING_OR_INVALID",`approve() relayProtocol: ${g}`);throw new Error(F)}Cr(w)||this.validateSessionProps(w,"sessionProperties")},this.isValidReject=async i=>{if(!Bt(i)){const{message:g}=T("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(g)}const{id:a,reason:h}=i;if(await this.isValidProposalId(a),!Cv(h)){const{message:g}=T("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(h)}`);throw new Error(g)}},this.isValidSessionSettleRequest=i=>{if(!Bt(i)){const{message:N}=T("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(N)}const{relay:a,controller:h,namespaces:g,expiry:w}=i;if(!Rv(a)){const{message:N}=T("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(N)}const b=Nv(h,"onSessionSettleRequest()");if(b)throw new Error(b.message);const S=is(g,"onSessionSettleRequest()");if(S)throw new Error(S.message);if(tr(w)){const{message:N}=T("EXPIRED","onSessionSettleRequest()");throw new Error(N)}},this.isValidUpdate=async i=>{if(!Bt(i)){const{message:S}=T("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(S)}const{topic:a,namespaces:h}=i;await this.isValidSessionTopic(a);const g=this.client.session.get(a),w=is(h,"update()");if(w)throw new Error(w.message);const b=Zo(g.requiredNamespaces,h,"update()");if(b)throw new Error(b.message)},this.isValidExtend=async i=>{if(!Bt(i)){const{message:h}=T("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(h)}const{topic:a}=i;await this.isValidSessionTopic(a)},this.isValidRequest=async i=>{if(!Bt(i)){const{message:S}=T("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(S)}const{topic:a,request:h,chainId:g,expiry:w}=i;await this.isValidSessionTopic(a);const{namespaces:b}=this.client.session.get(a);if(!Xo(b,g)){const{message:S}=T("MISSING_OR_INVALID",`request() chainId: ${g}`);throw new Error(S)}if(!Av(h)){const{message:S}=T("MISSING_OR_INVALID",`request() ${JSON.stringify(h)}`);throw new Error(S)}if(!Ov(b,g,h.method)){const{message:S}=T("MISSING_OR_INVALID",`request() method: ${h.method}`);throw new Error(S)}if(w&&!Dv(w,as)){const{message:S}=T("MISSING_OR_INVALID",`request() expiry: ${w}. Expiry must be a number (in seconds) between ${as.min} and ${as.max}`);throw new Error(S)}},this.isValidRespond=async i=>{if(!Bt(i)){const{message:g}=T("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(g)}const{topic:a,response:h}=i;if(await this.isValidSessionTopic(a),!qv(h)){const{message:g}=T("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(g)}},this.isValidPing=async i=>{if(!Bt(i)){const{message:h}=T("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(h)}const{topic:a}=i;await this.isValidSessionOrPairingTopic(a)},this.isValidEmit=async i=>{if(!Bt(i)){const{message:b}=T("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(b)}const{topic:a,event:h,chainId:g}=i;await this.isValidSessionTopic(a);const{namespaces:w}=this.client.session.get(a);if(!Xo(w,g)){const{message:b}=T("MISSING_OR_INVALID",`emit() chainId: ${g}`);throw new Error(b)}if(!xv(h)){const{message:b}=T("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(h)}`);throw new Error(b)}if(!$v(w,g,h.name)){const{message:b}=T("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(h)}`);throw new Error(b)}},this.isValidDisconnect=async i=>{if(!Bt(i)){const{message:h}=T("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(h)}const{topic:a}=i;await this.isValidSessionOrPairingTopic(a)},this.getVerifyContext=async(i,a)=>{const h={verified:{verifyUrl:a.verifyUrl||"",validation:"UNKNOWN",origin:a.url||""}};try{const g=await this.client.core.verify.resolve({attestationId:i,verifyUrl:a.verifyUrl});g&&(h.verified.origin=g,h.verified.validation=g===a.url?"VALID":"INVALID")}catch(g){this.client.logger.error(g)}return this.client.logger.info(`Verify context: ${JSON.stringify(h)}`),h},this.validateSessionProps=(i,a)=>{Object.values(i).forEach(h=>{if(!Rr(h,!1)){const{message:g}=T("MISSING_OR_INVALID",`${a} must be in Record<string, string> format. Received: ${JSON.stringify(h)}`);throw new Error(g)}})}}isInitialized(){if(!this.initialized){const{message:s}=T("NOT_INITIALIZED",this.name);throw new Error(s)}}registerRelayerEvents(){this.client.core.relayer.on(Ci.message,async s=>{const{topic:i,message:a}=s;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(a)))return;const h=await this.client.core.crypto.decode(i,a);Wv(h)?(this.client.core.history.set(i,h),this.onRelayEventRequest({topic:i,payload:h})):Bv(h)?(await this.client.core.history.resolve(h),await this.onRelayEventResponse({topic:i,payload:h}),this.client.core.history.delete(i,h.id)):this.onRelayEventUnknownPayload({topic:i,payload:h})})}registerExpirerEvents(){this.client.core.expirer.on(Fv.expired,async s=>{const{topic:i,id:a}=jv(s.target);if(a&&this.client.pendingRequest.keys.includes(a))return await this.deletePendingSessionRequest(a,T("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):a&&(await this.deleteProposal(a,!0),this.client.events.emit("proposal_expire",{id:a}))})}isValidPairingTopic(s){if(!Rr(s,!1)){const{message:i}=T("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(s)){const{message:i}=T("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(i)}if(tr(this.client.core.pairing.pairings.get(s).expiry)){const{message:i}=T("EXPIRED",`pairing topic: ${s}`);throw new Error(i)}}async isValidSessionTopic(s){if(!Rr(s,!1)){const{message:i}=T("MISSING_OR_INVALID",`session topic should be a string: ${s}`);throw new Error(i)}if(!this.client.session.keys.includes(s)){const{message:i}=T("NO_MATCHING_KEY",`session topic doesn't exist: ${s}`);throw new Error(i)}if(tr(this.client.session.get(s).expiry)){await this.deleteSession(s);const{message:i}=T("EXPIRED",`session topic: ${s}`);throw new Error(i)}}async isValidSessionOrPairingTopic(s){if(this.client.session.keys.includes(s))await this.isValidSessionTopic(s);else if(this.client.core.pairing.pairings.keys.includes(s))this.isValidPairingTopic(s);else if(Rr(s,!1)){const{message:i}=T("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${s}`);throw new Error(i)}else{const{message:i}=T("MISSING_OR_INVALID",`session or pairing topic should be a string: ${s}`);throw new Error(i)}}async isValidProposalId(s){if(!Tv(s)){const{message:i}=T("MISSING_OR_INVALID",`proposal id should be a number: ${s}`);throw new Error(i)}if(!this.client.proposal.keys.includes(s)){const{message:i}=T("NO_MATCHING_KEY",`proposal id doesn't exist: ${s}`);throw new Error(i)}if(tr(this.client.proposal.get(s).expiry)){await this.deleteProposal(s);const{message:i}=T("EXPIRED",`proposal id: ${s}`);throw new Error(i)}}}class c0 extends gs{constructor(s,i){super(s,i,Qv,vs),this.core=s,this.logger=i}}class u0 extends gs{constructor(s,i){super(s,i,Zv,vs),this.core=s,this.logger=i}}class h0 extends gs{constructor(s,i){super(s,i,t0,vs,a=>a.id),this.core=s,this.logger=i}}let l0=class yc extends Uv{constructor(s){super(s),this.protocol=gc,this.version=vc,this.name=ss.name,this.events=new pc.EventEmitter,this.on=(a,h)=>this.events.on(a,h),this.once=(a,h)=>this.events.once(a,h),this.off=(a,h)=>this.events.off(a,h),this.removeListener=(a,h)=>this.events.removeListener(a,h),this.removeAllListeners=a=>this.events.removeAllListeners(a),this.connect=async a=>{try{return await this.engine.connect(a)}catch(h){throw this.logger.error(h.message),h}},this.pair=async a=>{try{return await this.engine.pair(a)}catch(h){throw this.logger.error(h.message),h}},this.approve=async a=>{try{return await this.engine.approve(a)}catch(h){throw this.logger.error(h.message),h}},this.reject=async a=>{try{return await this.engine.reject(a)}catch(h){throw this.logger.error(h.message),h}},this.update=async a=>{try{return await this.engine.update(a)}catch(h){throw this.logger.error(h.message),h}},this.extend=async a=>{try{return await this.engine.extend(a)}catch(h){throw this.logger.error(h.message),h}},this.request=async a=>{try{return await this.engine.request(a)}catch(h){throw this.logger.error(h.message),h}},this.respond=async a=>{try{return await this.engine.respond(a)}catch(h){throw this.logger.error(h.message),h}},this.ping=async a=>{try{return await this.engine.ping(a)}catch(h){throw this.logger.error(h.message),h}},this.emit=async a=>{try{return await this.engine.emit(a)}catch(h){throw this.logger.error(h.message),h}},this.disconnect=async a=>{try{return await this.engine.disconnect(a)}catch(h){throw this.logger.error(h.message),h}},this.find=a=>{try{return this.engine.find(a)}catch(h){throw this.logger.error(h.message),h}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(a){throw this.logger.error(a.message),a}},this.name=s?.name||ss.name,this.metadata=s?.metadata||_v();const i=typeof s?.logger<"u"&&typeof s?.logger!="string"?s.logger:er.pino(er.getDefaultLoggerOptions({level:s?.logger||ss.logger}));this.core=s?.core||new kv(s),this.logger=er.generateChildLogger(i,this.name),this.session=new u0(this.core,this.logger),this.proposal=new c0(this.core,this.logger),this.pendingRequest=new h0(this.core,this.logger),this.engine=new o0(this)}static async init(s){const i=new yc(s);return await i.initialize(),i}get context(){return er.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(s){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(s.message),s}}};const rc="error",p0="wss://relay.walletconnect.com",f0="wc",d0="universal_provider",ic=`${f0}@2:${d0}:`,g0="https://rpc.walletconnect.com/v1",Ie={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ar=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ls={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(E,s){(function(){var i,a="4.17.21",h=200,g="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",w="Expected a function",b="Invalid `variable` option passed into `_.template`",S="__lodash_hash_undefined__",N=500,F="__lodash_placeholder__",Y=1,G=2,Q=4,nt=1,Kt=2,ft=1,Ot=2,qr=4,ut=8,ot=16,bt=32,Me=64,te=128,rr=256,xi=512,Ec=30,bc="...",Pc=800,Sc=16,ys=1,Cc=2,Rc=3,Ee=1/0,le=9007199254740991,Nc=17976931348623157e292,xr=0/0,Jt=4294967295,Ac=Jt-1,Oc=Jt>>>1,Dc=[["ary",te],["bind",ft],["bindKey",Ot],["curry",ut],["curryRight",ot],["flip",xi],["partial",bt],["partialRight",Me],["rearg",rr]],Ve="[object Arguments]",$r="[object Array]",qc="[object AsyncFunction]",ir="[object Boolean]",nr="[object Date]",xc="[object DOMException]",jr="[object Error]",Tr="[object Function]",ws="[object GeneratorFunction]",Lt="[object Map]",sr="[object Number]",$c="[object Null]",ee="[object Object]",Is="[object Promise]",jc="[object Proxy]",ar="[object RegExp]",zt="[object Set]",or="[object String]",Mr="[object Symbol]",Tc="[object Undefined]",cr="[object WeakMap]",Mc="[object WeakSet]",ur="[object ArrayBuffer]",Ue="[object DataView]",$i="[object Float32Array]",ji="[object Float64Array]",Ti="[object Int8Array]",Mi="[object Int16Array]",Vi="[object Int32Array]",Ui="[object Uint8Array]",ki="[object Uint8ClampedArray]",Li="[object Uint16Array]",zi="[object Uint32Array]",Vc=/\b__p \+= '';/g,Uc=/\b(__p \+=) '' \+/g,kc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Es=/&(?:amp|lt|gt|quot|#39);/g,bs=/[&<>"']/g,Lc=RegExp(Es.source),zc=RegExp(bs.source),Fc=/<%-([\s\S]+?)%>/g,Hc=/<%([\s\S]+?)%>/g,Ps=/<%=([\s\S]+?)%>/g,Gc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wc=/^\w*$/,Bc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fi=/[\\^$.*+?()[\]{}|]/g,Kc=RegExp(Fi.source),Hi=/^\s+/,Jc=/\s/,Yc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qc=/\{\n\/\* \[wrapped with (.+)\] \*/,Zc=/,? & /,Xc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tu=/[()=,{}\[\]\/\s]/,eu=/\\(\\)?/g,ru=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ss=/\w*$/,iu=/^[-+]0x[0-9a-f]+$/i,nu=/^0b[01]+$/i,su=/^\[object .+?Constructor\]$/,au=/^0o[0-7]+$/i,ou=/^(?:0|[1-9]\d*)$/,cu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vr=/($^)/,uu=/['\n\r\u2028\u2029\\]/g,Ur="\\ud800-\\udfff",hu="\\u0300-\\u036f",lu="\\ufe20-\\ufe2f",pu="\\u20d0-\\u20ff",Cs=hu+lu+pu,Rs="\\u2700-\\u27bf",Ns="a-z\\xdf-\\xf6\\xf8-\\xff",fu="\\xac\\xb1\\xd7\\xf7",du="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",gu="\\u2000-\\u206f",vu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",As="A-Z\\xc0-\\xd6\\xd8-\\xde",Os="\\ufe0e\\ufe0f",Ds=fu+du+gu+vu,Gi="['’]",mu="["+Ur+"]",qs="["+Ds+"]",kr="["+Cs+"]",xs="\\d+",_u="["+Rs+"]",$s="["+Ns+"]",js="[^"+Ur+Ds+xs+Rs+Ns+As+"]",Wi="\\ud83c[\\udffb-\\udfff]",yu="(?:"+kr+"|"+Wi+")",Ts="[^"+Ur+"]",Bi="(?:\\ud83c[\\udde6-\\uddff]){2}",Ki="[\\ud800-\\udbff][\\udc00-\\udfff]",ke="["+As+"]",Ms="\\u200d",Vs="(?:"+$s+"|"+js+")",wu="(?:"+ke+"|"+js+")",Us="(?:"+Gi+"(?:d|ll|m|re|s|t|ve))?",ks="(?:"+Gi+"(?:D|LL|M|RE|S|T|VE))?",Ls=yu+"?",zs="["+Os+"]?",Iu="(?:"+Ms+"(?:"+[Ts,Bi,Ki].join("|")+")"+zs+Ls+")*",Eu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fs=zs+Ls+Iu,Pu="(?:"+[_u,Bi,Ki].join("|")+")"+Fs,Su="(?:"+[Ts+kr+"?",kr,Bi,Ki,mu].join("|")+")",Cu=RegExp(Gi,"g"),Ru=RegExp(kr,"g"),Ji=RegExp(Wi+"(?="+Wi+")|"+Su+Fs,"g"),Nu=RegExp([ke+"?"+$s+"+"+Us+"(?="+[qs,ke,"$"].join("|")+")",wu+"+"+ks+"(?="+[qs,ke+Vs,"$"].join("|")+")",ke+"?"+Vs+"+"+Us,ke+"+"+ks,bu,Eu,xs,Pu].join("|"),"g"),Au=RegExp("["+Ms+Ur+Cs+Os+"]"),Ou=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Du=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qu=-1,K={};K[$i]=K[ji]=K[Ti]=K[Mi]=K[Vi]=K[Ui]=K[ki]=K[Li]=K[zi]=!0,K[Ve]=K[$r]=K[ur]=K[ir]=K[Ue]=K[nr]=K[jr]=K[Tr]=K[Lt]=K[sr]=K[ee]=K[ar]=K[zt]=K[or]=K[cr]=!1;var B={};B[Ve]=B[$r]=B[ur]=B[Ue]=B[ir]=B[nr]=B[$i]=B[ji]=B[Ti]=B[Mi]=B[Vi]=B[Lt]=B[sr]=B[ee]=B[ar]=B[zt]=B[or]=B[Mr]=B[Ui]=B[ki]=B[Li]=B[zi]=!0,B[jr]=B[Tr]=B[cr]=!1;var xu={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},$u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ju={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Tu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Mu=parseFloat,Vu=parseInt,Hs=typeof Ar=="object"&&Ar&&Ar.Object===Object&&Ar,Uu=typeof self=="object"&&self&&self.Object===Object&&self,ht=Hs||Uu||Function("return this")(),Yi=s&&!s.nodeType&&s,be=Yi&&!0&&E&&!E.nodeType&&E,Gs=be&&be.exports===Yi,Qi=Gs&&Hs.process,Dt=function(){try{var f=be&&be.require&&be.require("util").types;return f||Qi&&Qi.binding&&Qi.binding("util")}catch{}}(),Ws=Dt&&Dt.isArrayBuffer,Bs=Dt&&Dt.isDate,Ks=Dt&&Dt.isMap,Js=Dt&&Dt.isRegExp,Ys=Dt&&Dt.isSet,Qs=Dt&&Dt.isTypedArray;function Pt(f,m,v){switch(v.length){case 0:return f.call(m);case 1:return f.call(m,v[0]);case 2:return f.call(m,v[0],v[1]);case 3:return f.call(m,v[0],v[1],v[2])}return f.apply(m,v)}function ku(f,m,v,C){for(var q=-1,L=f==null?0:f.length;++q<L;){var st=f[q];m(C,st,v(st),f)}return C}function qt(f,m){for(var v=-1,C=f==null?0:f.length;++v<C&&m(f[v],v,f)!==!1;);return f}function Lu(f,m){for(var v=f==null?0:f.length;v--&&m(f[v],v,f)!==!1;);return f}function Zs(f,m){for(var v=-1,C=f==null?0:f.length;++v<C;)if(!m(f[v],v,f))return!1;return!0}function pe(f,m){for(var v=-1,C=f==null?0:f.length,q=0,L=[];++v<C;){var st=f[v];m(st,v,f)&&(L[q++]=st)}return L}function Lr(f,m){var v=f==null?0:f.length;return!!v&&Le(f,m,0)>-1}function Zi(f,m,v){for(var C=-1,q=f==null?0:f.length;++C<q;)if(v(m,f[C]))return!0;return!1}function J(f,m){for(var v=-1,C=f==null?0:f.length,q=Array(C);++v<C;)q[v]=m(f[v],v,f);return q}function fe(f,m){for(var v=-1,C=m.length,q=f.length;++v<C;)f[q+v]=m[v];return f}function Xi(f,m,v,C){var q=-1,L=f==null?0:f.length;for(C&&L&&(v=f[++q]);++q<L;)v=m(v,f[q],q,f);return v}function zu(f,m,v,C){var q=f==null?0:f.length;for(C&&q&&(v=f[--q]);q--;)v=m(v,f[q],q,f);return v}function tn(f,m){for(var v=-1,C=f==null?0:f.length;++v<C;)if(m(f[v],v,f))return!0;return!1}var Fu=en("length");function Hu(f){return f.split("")}function Gu(f){return f.match(Xc)||[]}function Xs(f,m,v){var C;return v(f,function(q,L,st){if(m(q,L,st))return C=L,!1}),C}function zr(f,m,v,C){for(var q=f.length,L=v+(C?1:-1);C?L--:++L<q;)if(m(f[L],L,f))return L;return-1}function Le(f,m,v){return m===m?ih(f,m,v):zr(f,ta,v)}function Wu(f,m,v,C){for(var q=v-1,L=f.length;++q<L;)if(C(f[q],m))return q;return-1}function ta(f){return f!==f}function ea(f,m){var v=f==null?0:f.length;return v?nn(f,m)/v:xr}function en(f){return function(m){return m==null?i:m[f]}}function rn(f){return function(m){return f==null?i:f[m]}}function ra(f,m,v,C,q){return q(f,function(L,st,W){v=C?(C=!1,L):m(v,L,st,W)}),v}function Bu(f,m){var v=f.length;for(f.sort(m);v--;)f[v]=f[v].value;return f}function nn(f,m){for(var v,C=-1,q=f.length;++C<q;){var L=m(f[C]);L!==i&&(v=v===i?L:v+L)}return v}function sn(f,m){for(var v=-1,C=Array(f);++v<f;)C[v]=m(v);return C}function Ku(f,m){return J(m,function(v){return[v,f[v]]})}function ia(f){return f&&f.slice(0,oa(f)+1).replace(Hi,"")}function St(f){return function(m){return f(m)}}function an(f,m){return J(m,function(v){return f[v]})}function hr(f,m){return f.has(m)}function na(f,m){for(var v=-1,C=f.length;++v<C&&Le(m,f[v],0)>-1;);return v}function sa(f,m){for(var v=f.length;v--&&Le(m,f[v],0)>-1;);return v}function Ju(f,m){for(var v=f.length,C=0;v--;)f[v]===m&&++C;return C}var Yu=rn(xu),Qu=rn($u);function Zu(f){return"\\"+Tu[f]}function Xu(f,m){return f==null?i:f[m]}function ze(f){return Au.test(f)}function th(f){return Ou.test(f)}function eh(f){for(var m,v=[];!(m=f.next()).done;)v.push(m.value);return v}function on(f){var m=-1,v=Array(f.size);return f.forEach(function(C,q){v[++m]=[q,C]}),v}function aa(f,m){return function(v){return f(m(v))}}function de(f,m){for(var v=-1,C=f.length,q=0,L=[];++v<C;){var st=f[v];(st===m||st===F)&&(f[v]=F,L[q++]=v)}return L}function Fr(f){var m=-1,v=Array(f.size);return f.forEach(function(C){v[++m]=C}),v}function rh(f){var m=-1,v=Array(f.size);return f.forEach(function(C){v[++m]=[C,C]}),v}function ih(f,m,v){for(var C=v-1,q=f.length;++C<q;)if(f[C]===m)return C;return-1}function nh(f,m,v){for(var C=v+1;C--;)if(f[C]===m)return C;return C}function Fe(f){return ze(f)?ah(f):Fu(f)}function Ft(f){return ze(f)?oh(f):Hu(f)}function oa(f){for(var m=f.length;m--&&Jc.test(f.charAt(m)););return m}var sh=rn(ju);function ah(f){for(var m=Ji.lastIndex=0;Ji.test(f);)++m;return m}function oh(f){return f.match(Ji)||[]}function ch(f){return f.match(Nu)||[]}var uh=function f(m){m=m==null?ht:He.defaults(ht.Object(),m,He.pick(ht,Du));var v=m.Array,C=m.Date,q=m.Error,L=m.Function,st=m.Math,W=m.Object,cn=m.RegExp,hh=m.String,xt=m.TypeError,Hr=v.prototype,lh=L.prototype,Ge=W.prototype,Gr=m["__core-js_shared__"],Wr=lh.toString,H=Ge.hasOwnProperty,ph=0,ca=function(){var t=/[^.]+$/.exec(Gr&&Gr.keys&&Gr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Br=Ge.toString,fh=Wr.call(W),dh=ht._,gh=cn("^"+Wr.call(H).replace(Fi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kr=Gs?m.Buffer:i,ge=m.Symbol,Jr=m.Uint8Array,ua=Kr?Kr.allocUnsafe:i,Yr=aa(W.getPrototypeOf,W),ha=W.create,la=Ge.propertyIsEnumerable,Qr=Hr.splice,pa=ge?ge.isConcatSpreadable:i,lr=ge?ge.iterator:i,Pe=ge?ge.toStringTag:i,Zr=function(){try{var t=Ae(W,"defineProperty");return t({},"",{}),t}catch{}}(),vh=m.clearTimeout!==ht.clearTimeout&&m.clearTimeout,mh=C&&C.now!==ht.Date.now&&C.now,_h=m.setTimeout!==ht.setTimeout&&m.setTimeout,Xr=st.ceil,ti=st.floor,un=W.getOwnPropertySymbols,yh=Kr?Kr.isBuffer:i,fa=m.isFinite,wh=Hr.join,Ih=aa(W.keys,W),at=st.max,dt=st.min,Eh=C.now,bh=m.parseInt,da=st.random,Ph=Hr.reverse,hn=Ae(m,"DataView"),pr=Ae(m,"Map"),ln=Ae(m,"Promise"),We=Ae(m,"Set"),fr=Ae(m,"WeakMap"),dr=Ae(W,"create"),ei=fr&&new fr,Be={},Sh=Oe(hn),Ch=Oe(pr),Rh=Oe(ln),Nh=Oe(We),Ah=Oe(fr),ri=ge?ge.prototype:i,gr=ri?ri.valueOf:i,ga=ri?ri.toString:i;function c(t){if(X(t)&&!x(t)&&!(t instanceof U)){if(t instanceof $t)return t;if(H.call(t,"__wrapped__"))return mo(t)}return new $t(t)}var Ke=function(){function t(){}return function(e){if(!Z(e))return{};if(ha)return ha(e);t.prototype=e;var r=new t;return t.prototype=i,r}}();function ii(){}function $t(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}c.templateSettings={escape:Fc,evaluate:Hc,interpolate:Ps,variable:"",imports:{_:c}},c.prototype=ii.prototype,c.prototype.constructor=c,$t.prototype=Ke(ii.prototype),$t.prototype.constructor=$t;function U(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Jt,this.__views__=[]}function Oh(){var t=new U(this.__wrapped__);return t.__actions__=yt(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=yt(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=yt(this.__views__),t}function Dh(){if(this.__filtered__){var t=new U(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function qh(){var t=this.__wrapped__.value(),e=this.__dir__,r=x(t),n=e<0,o=r?t.length:0,u=Hl(0,o,this.__views__),l=u.start,p=u.end,d=p-l,_=n?p:l-1,y=this.__iteratees__,I=y.length,P=0,R=dt(d,this.__takeCount__);if(!r||!n&&o==d&&R==d)return Ua(t,this.__actions__);var O=[];t:for(;d--&&P<R;){_+=e;for(var j=-1,D=t[_];++j<I;){var V=y[j],k=V.iteratee,Nt=V.type,_t=k(D);if(Nt==Cc)D=_t;else if(!_t){if(Nt==ys)continue t;break t}}O[P++]=D}return O}U.prototype=Ke(ii.prototype),U.prototype.constructor=U;function Se(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function xh(){this.__data__=dr?dr(null):{},this.size=0}function $h(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function jh(t){var e=this.__data__;if(dr){var r=e[t];return r===S?i:r}return H.call(e,t)?e[t]:i}function Th(t){var e=this.__data__;return dr?e[t]!==i:H.call(e,t)}function Mh(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=dr&&e===i?S:e,this}Se.prototype.clear=xh,Se.prototype.delete=$h,Se.prototype.get=jh,Se.prototype.has=Th,Se.prototype.set=Mh;function re(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Vh(){this.__data__=[],this.size=0}function Uh(t){var e=this.__data__,r=ni(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Qr.call(e,r,1),--this.size,!0}function kh(t){var e=this.__data__,r=ni(e,t);return r<0?i:e[r][1]}function Lh(t){return ni(this.__data__,t)>-1}function zh(t,e){var r=this.__data__,n=ni(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}re.prototype.clear=Vh,re.prototype.delete=Uh,re.prototype.get=kh,re.prototype.has=Lh,re.prototype.set=zh;function ie(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Fh(){this.size=0,this.__data__={hash:new Se,map:new(pr||re),string:new Se}}function Hh(t){var e=vi(this,t).delete(t);return this.size-=e?1:0,e}function Gh(t){return vi(this,t).get(t)}function Wh(t){return vi(this,t).has(t)}function Bh(t,e){var r=vi(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}ie.prototype.clear=Fh,ie.prototype.delete=Hh,ie.prototype.get=Gh,ie.prototype.has=Wh,ie.prototype.set=Bh;function Ce(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new ie;++e<r;)this.add(t[e])}function Kh(t){return this.__data__.set(t,S),this}function Jh(t){return this.__data__.has(t)}Ce.prototype.add=Ce.prototype.push=Kh,Ce.prototype.has=Jh;function Ht(t){var e=this.__data__=new re(t);this.size=e.size}function Yh(){this.__data__=new re,this.size=0}function Qh(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Zh(t){return this.__data__.get(t)}function Xh(t){return this.__data__.has(t)}function tl(t,e){var r=this.__data__;if(r instanceof re){var n=r.__data__;if(!pr||n.length<h-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new ie(n)}return r.set(t,e),this.size=r.size,this}Ht.prototype.clear=Yh,Ht.prototype.delete=Qh,Ht.prototype.get=Zh,Ht.prototype.has=Xh,Ht.prototype.set=tl;function va(t,e){var r=x(t),n=!r&&De(t),o=!r&&!n&&we(t),u=!r&&!n&&!o&&Ze(t),l=r||n||o||u,p=l?sn(t.length,hh):[],d=p.length;for(var _ in t)(e||H.call(t,_))&&!(l&&(_=="length"||o&&(_=="offset"||_=="parent")||u&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||oe(_,d)))&&p.push(_);return p}function ma(t){var e=t.length;return e?t[En(0,e-1)]:i}function el(t,e){return mi(yt(t),Re(e,0,t.length))}function rl(t){return mi(yt(t))}function pn(t,e,r){(r!==i&&!Gt(t[e],r)||r===i&&!(e in t))&&ne(t,e,r)}function vr(t,e,r){var n=t[e];(!(H.call(t,e)&&Gt(n,r))||r===i&&!(e in t))&&ne(t,e,r)}function ni(t,e){for(var r=t.length;r--;)if(Gt(t[r][0],e))return r;return-1}function il(t,e,r,n){return ve(t,function(o,u,l){e(n,o,r(o),l)}),n}function _a(t,e){return t&&Qt(e,ct(e),t)}function nl(t,e){return t&&Qt(e,It(e),t)}function ne(t,e,r){e=="__proto__"&&Zr?Zr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function fn(t,e){for(var r=-1,n=e.length,o=v(n),u=t==null;++r<n;)o[r]=u?i:Bn(t,e[r]);return o}function Re(t,e,r){return t===t&&(r!==i&&(t=t<=r?t:r),e!==i&&(t=t>=e?t:e)),t}function jt(t,e,r,n,o,u){var l,p=e&Y,d=e&G,_=e&Q;if(r&&(l=o?r(t,n,o,u):r(t)),l!==i)return l;if(!Z(t))return t;var y=x(t);if(y){if(l=Wl(t),!p)return yt(t,l)}else{var I=gt(t),P=I==Tr||I==ws;if(we(t))return za(t,p);if(I==ee||I==Ve||P&&!o){if(l=d||P?{}:oo(t),!p)return d?jl(t,nl(l,t)):$l(t,_a(l,t))}else{if(!B[I])return o?t:{};l=Bl(t,I,p)}}u||(u=new Ht);var R=u.get(t);if(R)return R;u.set(t,l),Mo(t)?t.forEach(function(D){l.add(jt(D,e,r,D,t,u))}):jo(t)&&t.forEach(function(D,V){l.set(V,jt(D,e,r,V,t,u))});var O=_?d?xn:qn:d?It:ct,j=y?i:O(t);return qt(j||t,function(D,V){j&&(V=D,D=t[V]),vr(l,V,jt(D,e,r,V,t,u))}),l}function sl(t){var e=ct(t);return function(r){return ya(r,t,e)}}function ya(t,e,r){var n=r.length;if(t==null)return!n;for(t=W(t);n--;){var o=r[n],u=e[o],l=t[o];if(l===i&&!(o in t)||!u(l))return!1}return!0}function wa(t,e,r){if(typeof t!="function")throw new xt(w);return br(function(){t.apply(i,r)},e)}function mr(t,e,r,n){var o=-1,u=Lr,l=!0,p=t.length,d=[],_=e.length;if(!p)return d;r&&(e=J(e,St(r))),n?(u=Zi,l=!1):e.length>=h&&(u=hr,l=!1,e=new Ce(e));t:for(;++o<p;){var y=t[o],I=r==null?y:r(y);if(y=n||y!==0?y:0,l&&I===I){for(var P=_;P--;)if(e[P]===I)continue t;d.push(y)}else u(e,I,n)||d.push(y)}return d}var ve=Ba(Yt),Ia=Ba(gn,!0);function al(t,e){var r=!0;return ve(t,function(n,o,u){return r=!!e(n,o,u),r}),r}function si(t,e,r){for(var n=-1,o=t.length;++n<o;){var u=t[n],l=e(u);if(l!=null&&(p===i?l===l&&!Rt(l):r(l,p)))var p=l,d=u}return d}function ol(t,e,r,n){var o=t.length;for(r=$(r),r<0&&(r=-r>o?0:o+r),n=n===i||n>o?o:$(n),n<0&&(n+=o),n=r>n?0:Uo(n);r<n;)t[r++]=e;return t}function Ea(t,e){var r=[];return ve(t,function(n,o,u){e(n,o,u)&&r.push(n)}),r}function lt(t,e,r,n,o){var u=-1,l=t.length;for(r||(r=Jl),o||(o=[]);++u<l;){var p=t[u];e>0&&r(p)?e>1?lt(p,e-1,r,n,o):fe(o,p):n||(o[o.length]=p)}return o}var dn=Ka(),ba=Ka(!0);function Yt(t,e){return t&&dn(t,e,ct)}function gn(t,e){return t&&ba(t,e,ct)}function ai(t,e){return pe(e,function(r){return ce(t[r])})}function Ne(t,e){e=_e(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Zt(e[r++])];return r&&r==n?t:i}function Pa(t,e,r){var n=e(t);return x(t)?n:fe(n,r(t))}function vt(t){return t==null?t===i?Tc:$c:Pe&&Pe in W(t)?Fl(t):rp(t)}function vn(t,e){return t>e}function cl(t,e){return t!=null&&H.call(t,e)}function ul(t,e){return t!=null&&e in W(t)}function hl(t,e,r){return t>=dt(e,r)&&t<at(e,r)}function mn(t,e,r){for(var n=r?Zi:Lr,o=t[0].length,u=t.length,l=u,p=v(u),d=1/0,_=[];l--;){var y=t[l];l&&e&&(y=J(y,St(e))),d=dt(y.length,d),p[l]=!r&&(e||o>=120&&y.length>=120)?new Ce(l&&y):i}y=t[0];var I=-1,P=p[0];t:for(;++I<o&&_.length<d;){var R=y[I],O=e?e(R):R;if(R=r||R!==0?R:0,!(P?hr(P,O):n(_,O,r))){for(l=u;--l;){var j=p[l];if(!(j?hr(j,O):n(t[l],O,r)))continue t}P&&P.push(O),_.push(R)}}return _}function ll(t,e,r,n){return Yt(t,function(o,u,l){e(n,r(o),u,l)}),n}function _r(t,e,r){e=_e(e,t),t=lo(t,e);var n=t==null?t:t[Zt(Mt(e))];return n==null?i:Pt(n,t,r)}function Sa(t){return X(t)&&vt(t)==Ve}function pl(t){return X(t)&&vt(t)==ur}function fl(t){return X(t)&&vt(t)==nr}function yr(t,e,r,n,o){return t===e?!0:t==null||e==null||!X(t)&&!X(e)?t!==t&&e!==e:dl(t,e,r,n,yr,o)}function dl(t,e,r,n,o,u){var l=x(t),p=x(e),d=l?$r:gt(t),_=p?$r:gt(e);d=d==Ve?ee:d,_=_==Ve?ee:_;var y=d==ee,I=_==ee,P=d==_;if(P&&we(t)){if(!we(e))return!1;l=!0,y=!1}if(P&&!y)return u||(u=new Ht),l||Ze(t)?no(t,e,r,n,o,u):Ll(t,e,d,r,n,o,u);if(!(r&nt)){var R=y&&H.call(t,"__wrapped__"),O=I&&H.call(e,"__wrapped__");if(R||O){var j=R?t.value():t,D=O?e.value():e;return u||(u=new Ht),o(j,D,r,n,u)}}return P?(u||(u=new Ht),zl(t,e,r,n,o,u)):!1}function gl(t){return X(t)&&gt(t)==Lt}function _n(t,e,r,n){var o=r.length,u=o,l=!n;if(t==null)return!u;for(t=W(t);o--;){var p=r[o];if(l&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++o<u;){p=r[o];var d=p[0],_=t[d],y=p[1];if(l&&p[2]){if(_===i&&!(d in t))return!1}else{var I=new Ht;if(n)var P=n(_,y,d,t,e,I);if(!(P===i?yr(y,_,nt|Kt,n,I):P))return!1}}return!0}function Ca(t){if(!Z(t)||Ql(t))return!1;var e=ce(t)?gh:su;return e.test(Oe(t))}function vl(t){return X(t)&&vt(t)==ar}function ml(t){return X(t)&&gt(t)==zt}function _l(t){return X(t)&&bi(t.length)&&!!K[vt(t)]}function Ra(t){return typeof t=="function"?t:t==null?Et:typeof t=="object"?x(t)?Oa(t[0],t[1]):Aa(t):Yo(t)}function yn(t){if(!Er(t))return Ih(t);var e=[];for(var r in W(t))H.call(t,r)&&r!="constructor"&&e.push(r);return e}function yl(t){if(!Z(t))return ep(t);var e=Er(t),r=[];for(var n in t)n=="constructor"&&(e||!H.call(t,n))||r.push(n);return r}function wn(t,e){return t<e}function Na(t,e){var r=-1,n=wt(t)?v(t.length):[];return ve(t,function(o,u,l){n[++r]=e(o,u,l)}),n}function Aa(t){var e=jn(t);return e.length==1&&e[0][2]?uo(e[0][0],e[0][1]):function(r){return r===t||_n(r,t,e)}}function Oa(t,e){return Mn(t)&&co(e)?uo(Zt(t),e):function(r){var n=Bn(r,t);return n===i&&n===e?Kn(r,t):yr(e,n,nt|Kt)}}function oi(t,e,r,n,o){t!==e&&dn(e,function(u,l){if(o||(o=new Ht),Z(u))wl(t,e,l,r,oi,n,o);else{var p=n?n(Un(t,l),u,l+"",t,e,o):i;p===i&&(p=u),pn(t,l,p)}},It)}function wl(t,e,r,n,o,u,l){var p=Un(t,r),d=Un(e,r),_=l.get(d);if(_){pn(t,r,_);return}var y=u?u(p,d,r+"",t,e,l):i,I=y===i;if(I){var P=x(d),R=!P&&we(d),O=!P&&!R&&Ze(d);y=d,P||R||O?x(p)?y=p:et(p)?y=yt(p):R?(I=!1,y=za(d,!0)):O?(I=!1,y=Fa(d,!0)):y=[]:Pr(d)||De(d)?(y=p,De(p)?y=ko(p):(!Z(p)||ce(p))&&(y=oo(d))):I=!1}I&&(l.set(d,y),o(y,d,n,u,l),l.delete(d)),pn(t,r,y)}function Da(t,e){var r=t.length;if(r)return e+=e<0?r:0,oe(e,r)?t[e]:i}function qa(t,e,r){e.length?e=J(e,function(u){return x(u)?function(l){return Ne(l,u.length===1?u[0]:u)}:u}):e=[Et];var n=-1;e=J(e,St(A()));var o=Na(t,function(u,l,p){var d=J(e,function(_){return _(u)});return{criteria:d,index:++n,value:u}});return Bu(o,function(u,l){return xl(u,l,r)})}function Il(t,e){return xa(t,e,function(r,n){return Kn(t,n)})}function xa(t,e,r){for(var n=-1,o=e.length,u={};++n<o;){var l=e[n],p=Ne(t,l);r(p,l)&&wr(u,_e(l,t),p)}return u}function El(t){return function(e){return Ne(e,t)}}function In(t,e,r,n){var o=n?Wu:Le,u=-1,l=e.length,p=t;for(t===e&&(e=yt(e)),r&&(p=J(t,St(r)));++u<l;)for(var d=0,_=e[u],y=r?r(_):_;(d=o(p,y,d,n))>-1;)p!==t&&Qr.call(p,d,1),Qr.call(t,d,1);return t}function $a(t,e){for(var r=t?e.length:0,n=r-1;r--;){var o=e[r];if(r==n||o!==u){var u=o;oe(o)?Qr.call(t,o,1):Sn(t,o)}}return t}function En(t,e){return t+ti(da()*(e-t+1))}function bl(t,e,r,n){for(var o=-1,u=at(Xr((e-t)/(r||1)),0),l=v(u);u--;)l[n?u:++o]=t,t+=r;return l}function bn(t,e){var r="";if(!t||e<1||e>le)return r;do e%2&&(r+=t),e=ti(e/2),e&&(t+=t);while(e);return r}function M(t,e){return kn(ho(t,e,Et),t+"")}function Pl(t){return ma(Xe(t))}function Sl(t,e){var r=Xe(t);return mi(r,Re(e,0,r.length))}function wr(t,e,r,n){if(!Z(t))return t;e=_e(e,t);for(var o=-1,u=e.length,l=u-1,p=t;p!=null&&++o<u;){var d=Zt(e[o]),_=r;if(d==="__proto__"||d==="constructor"||d==="prototype")return t;if(o!=l){var y=p[d];_=n?n(y,d,p):i,_===i&&(_=Z(y)?y:oe(e[o+1])?[]:{})}vr(p,d,_),p=p[d]}return t}var ja=ei?function(t,e){return ei.set(t,e),t}:Et,Cl=Zr?function(t,e){return Zr(t,"toString",{configurable:!0,enumerable:!1,value:Yn(e),writable:!0})}:Et;function Rl(t){return mi(Xe(t))}function Tt(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var u=v(o);++n<o;)u[n]=t[n+e];return u}function Nl(t,e){var r;return ve(t,function(n,o,u){return r=e(n,o,u),!r}),!!r}function ci(t,e,r){var n=0,o=t==null?n:t.length;if(typeof e=="number"&&e===e&&o<=Oc){for(;n<o;){var u=n+o>>>1,l=t[u];l!==null&&!Rt(l)&&(r?l<=e:l<e)?n=u+1:o=u}return o}return Pn(t,e,Et,r)}function Pn(t,e,r,n){var o=0,u=t==null?0:t.length;if(u===0)return 0;e=r(e);for(var l=e!==e,p=e===null,d=Rt(e),_=e===i;o<u;){var y=ti((o+u)/2),I=r(t[y]),P=I!==i,R=I===null,O=I===I,j=Rt(I);if(l)var D=n||O;else _?D=O&&(n||P):p?D=O&&P&&(n||!R):d?D=O&&P&&!R&&(n||!j):R||j?D=!1:D=n?I<=e:I<e;D?o=y+1:u=y}return dt(u,Ac)}function Ta(t,e){for(var r=-1,n=t.length,o=0,u=[];++r<n;){var l=t[r],p=e?e(l):l;if(!r||!Gt(p,d)){var d=p;u[o++]=l===0?0:l}}return u}function Ma(t){return typeof t=="number"?t:Rt(t)?xr:+t}function Ct(t){if(typeof t=="string")return t;if(x(t))return J(t,Ct)+"";if(Rt(t))return ga?ga.call(t):"";var e=t+"";return e=="0"&&1/t==-Ee?"-0":e}function me(t,e,r){var n=-1,o=Lr,u=t.length,l=!0,p=[],d=p;if(r)l=!1,o=Zi;else if(u>=h){var _=e?null:Ul(t);if(_)return Fr(_);l=!1,o=hr,d=new Ce}else d=e?[]:p;t:for(;++n<u;){var y=t[n],I=e?e(y):y;if(y=r||y!==0?y:0,l&&I===I){for(var P=d.length;P--;)if(d[P]===I)continue t;e&&d.push(I),p.push(y)}else o(d,I,r)||(d!==p&&d.push(I),p.push(y))}return p}function Sn(t,e){return e=_e(e,t),t=lo(t,e),t==null||delete t[Zt(Mt(e))]}function Va(t,e,r,n){return wr(t,e,r(Ne(t,e)),n)}function ui(t,e,r,n){for(var o=t.length,u=n?o:-1;(n?u--:++u<o)&&e(t[u],u,t););return r?Tt(t,n?0:u,n?u+1:o):Tt(t,n?u+1:0,n?o:u)}function Ua(t,e){var r=t;return r instanceof U&&(r=r.value()),Xi(e,function(n,o){return o.func.apply(o.thisArg,fe([n],o.args))},r)}function Cn(t,e,r){var n=t.length;if(n<2)return n?me(t[0]):[];for(var o=-1,u=v(n);++o<n;)for(var l=t[o],p=-1;++p<n;)p!=o&&(u[o]=mr(u[o]||l,t[p],e,r));return me(lt(u,1),e,r)}function ka(t,e,r){for(var n=-1,o=t.length,u=e.length,l={};++n<o;){var p=n<u?e[n]:i;r(l,t[n],p)}return l}function Rn(t){return et(t)?t:[]}function Nn(t){return typeof t=="function"?t:Et}function _e(t,e){return x(t)?t:Mn(t,e)?[t]:vo(z(t))}var Al=M;function ye(t,e,r){var n=t.length;return r=r===i?n:r,!e&&r>=n?t:Tt(t,e,r)}var La=vh||function(t){return ht.clearTimeout(t)};function za(t,e){if(e)return t.slice();var r=t.length,n=ua?ua(r):new t.constructor(r);return t.copy(n),n}function An(t){var e=new t.constructor(t.byteLength);return new Jr(e).set(new Jr(t)),e}function Ol(t,e){var r=e?An(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}function Dl(t){var e=new t.constructor(t.source,Ss.exec(t));return e.lastIndex=t.lastIndex,e}function ql(t){return gr?W(gr.call(t)):{}}function Fa(t,e){var r=e?An(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Ha(t,e){if(t!==e){var r=t!==i,n=t===null,o=t===t,u=Rt(t),l=e!==i,p=e===null,d=e===e,_=Rt(e);if(!p&&!_&&!u&&t>e||u&&l&&d&&!p&&!_||n&&l&&d||!r&&d||!o)return 1;if(!n&&!u&&!_&&t<e||_&&r&&o&&!n&&!u||p&&r&&o||!l&&o||!d)return-1}return 0}function xl(t,e,r){for(var n=-1,o=t.criteria,u=e.criteria,l=o.length,p=r.length;++n<l;){var d=Ha(o[n],u[n]);if(d){if(n>=p)return d;var _=r[n];return d*(_=="desc"?-1:1)}}return t.index-e.index}function Ga(t,e,r,n){for(var o=-1,u=t.length,l=r.length,p=-1,d=e.length,_=at(u-l,0),y=v(d+_),I=!n;++p<d;)y[p]=e[p];for(;++o<l;)(I||o<u)&&(y[r[o]]=t[o]);for(;_--;)y[p++]=t[o++];return y}function Wa(t,e,r,n){for(var o=-1,u=t.length,l=-1,p=r.length,d=-1,_=e.length,y=at(u-p,0),I=v(y+_),P=!n;++o<y;)I[o]=t[o];for(var R=o;++d<_;)I[R+d]=e[d];for(;++l<p;)(P||o<u)&&(I[R+r[l]]=t[o++]);return I}function yt(t,e){var r=-1,n=t.length;for(e||(e=v(n));++r<n;)e[r]=t[r];return e}function Qt(t,e,r,n){var o=!r;r||(r={});for(var u=-1,l=e.length;++u<l;){var p=e[u],d=n?n(r[p],t[p],p,r,t):i;d===i&&(d=t[p]),o?ne(r,p,d):vr(r,p,d)}return r}function $l(t,e){return Qt(t,Tn(t),e)}function jl(t,e){return Qt(t,so(t),e)}function hi(t,e){return function(r,n){var o=x(r)?ku:il,u=e?e():{};return o(r,t,A(n,2),u)}}function Je(t){return M(function(e,r){var n=-1,o=r.length,u=o>1?r[o-1]:i,l=o>2?r[2]:i;for(u=t.length>3&&typeof u=="function"?(o--,u):i,l&&mt(r[0],r[1],l)&&(u=o<3?i:u,o=1),e=W(e);++n<o;){var p=r[n];p&&t(e,p,n,u)}return e})}function Ba(t,e){return function(r,n){if(r==null)return r;if(!wt(r))return t(r,n);for(var o=r.length,u=e?o:-1,l=W(r);(e?u--:++u<o)&&n(l[u],u,l)!==!1;);return r}}function Ka(t){return function(e,r,n){for(var o=-1,u=W(e),l=n(e),p=l.length;p--;){var d=l[t?p:++o];if(r(u[d],d,u)===!1)break}return e}}function Tl(t,e,r){var n=e&ft,o=Ir(t);function u(){var l=this&&this!==ht&&this instanceof u?o:t;return l.apply(n?r:this,arguments)}return u}function Ja(t){return function(e){e=z(e);var r=ze(e)?Ft(e):i,n=r?r[0]:e.charAt(0),o=r?ye(r,1).join(""):e.slice(1);return n[t]()+o}}function Ye(t){return function(e){return Xi(Ko(Bo(e).replace(Cu,"")),t,"")}}function Ir(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Ke(t.prototype),n=t.apply(r,e);return Z(n)?n:r}}function Ml(t,e,r){var n=Ir(t);function o(){for(var u=arguments.length,l=v(u),p=u,d=Qe(o);p--;)l[p]=arguments[p];var _=u<3&&l[0]!==d&&l[u-1]!==d?[]:de(l,d);if(u-=_.length,u<r)return to(t,e,li,o.placeholder,i,l,_,i,i,r-u);var y=this&&this!==ht&&this instanceof o?n:t;return Pt(y,this,l)}return o}function Ya(t){return function(e,r,n){var o=W(e);if(!wt(e)){var u=A(r,3);e=ct(e),r=function(p){return u(o[p],p,o)}}var l=t(e,r,n);return l>-1?o[u?e[l]:l]:i}}function Qa(t){return ae(function(e){var r=e.length,n=r,o=$t.prototype.thru;for(t&&e.reverse();n--;){var u=e[n];if(typeof u!="function")throw new xt(w);if(o&&!l&&gi(u)=="wrapper")var l=new $t([],!0)}for(n=l?n:r;++n<r;){u=e[n];var p=gi(u),d=p=="wrapper"?$n(u):i;d&&Vn(d[0])&&d[1]==(te|ut|bt|rr)&&!d[4].length&&d[9]==1?l=l[gi(d[0])].apply(l,d[3]):l=u.length==1&&Vn(u)?l[p]():l.thru(u)}return function(){var _=arguments,y=_[0];if(l&&_.length==1&&x(y))return l.plant(y).value();for(var I=0,P=r?e[I].apply(this,_):y;++I<r;)P=e[I].call(this,P);return P}})}function li(t,e,r,n,o,u,l,p,d,_){var y=e&te,I=e&ft,P=e&Ot,R=e&(ut|ot),O=e&xi,j=P?i:Ir(t);function D(){for(var V=arguments.length,k=v(V),Nt=V;Nt--;)k[Nt]=arguments[Nt];if(R)var _t=Qe(D),At=Ju(k,_t);if(n&&(k=Ga(k,n,o,R)),u&&(k=Wa(k,u,l,R)),V-=At,R&&V<_){var rt=de(k,_t);return to(t,e,li,D.placeholder,r,k,rt,p,d,_-V)}var Wt=I?r:this,he=P?Wt[t]:t;return V=k.length,p?k=ip(k,p):O&&V>1&&k.reverse(),y&&d<V&&(k.length=d),this&&this!==ht&&this instanceof D&&(he=j||Ir(he)),he.apply(Wt,k)}return D}function Za(t,e){return function(r,n){return ll(r,t,e(n),{})}}function pi(t,e){return function(r,n){var o;if(r===i&&n===i)return e;if(r!==i&&(o=r),n!==i){if(o===i)return n;typeof r=="string"||typeof n=="string"?(r=Ct(r),n=Ct(n)):(r=Ma(r),n=Ma(n)),o=t(r,n)}return o}}function On(t){return ae(function(e){return e=J(e,St(A())),M(function(r){var n=this;return t(e,function(o){return Pt(o,n,r)})})})}function fi(t,e){e=e===i?" ":Ct(e);var r=e.length;if(r<2)return r?bn(e,t):e;var n=bn(e,Xr(t/Fe(e)));return ze(e)?ye(Ft(n),0,t).join(""):n.slice(0,t)}function Vl(t,e,r,n){var o=e&ft,u=Ir(t);function l(){for(var p=-1,d=arguments.length,_=-1,y=n.length,I=v(y+d),P=this&&this!==ht&&this instanceof l?u:t;++_<y;)I[_]=n[_];for(;d--;)I[_++]=arguments[++p];return Pt(P,o?r:this,I)}return l}function Xa(t){return function(e,r,n){return n&&typeof n!="number"&&mt(e,r,n)&&(r=n=i),e=ue(e),r===i?(r=e,e=0):r=ue(r),n=n===i?e<r?1:-1:ue(n),bl(e,r,n,t)}}function di(t){return function(e,r){return typeof e=="string"&&typeof r=="string"||(e=Vt(e),r=Vt(r)),t(e,r)}}function to(t,e,r,n,o,u,l,p,d,_){var y=e&ut,I=y?l:i,P=y?i:l,R=y?u:i,O=y?i:u;e|=y?bt:Me,e&=~(y?Me:bt),e&qr||(e&=~(ft|Ot));var j=[t,e,o,R,I,O,P,p,d,_],D=r.apply(i,j);return Vn(t)&&po(D,j),D.placeholder=n,fo(D,t,e)}function Dn(t){var e=st[t];return function(r,n){if(r=Vt(r),n=n==null?0:dt($(n),292),n&&fa(r)){var o=(z(r)+"e").split("e"),u=e(o[0]+"e"+(+o[1]+n));return o=(z(u)+"e").split("e"),+(o[0]+"e"+(+o[1]-n))}return e(r)}}var Ul=We&&1/Fr(new We([,-0]))[1]==Ee?function(t){return new We(t)}:Xn;function eo(t){return function(e){var r=gt(e);return r==Lt?on(e):r==zt?rh(e):Ku(e,t(e))}}function se(t,e,r,n,o,u,l,p){var d=e&Ot;if(!d&&typeof t!="function")throw new xt(w);var _=n?n.length:0;if(_||(e&=~(bt|Me),n=o=i),l=l===i?l:at($(l),0),p=p===i?p:$(p),_-=o?o.length:0,e&Me){var y=n,I=o;n=o=i}var P=d?i:$n(t),R=[t,e,r,n,o,y,I,u,l,p];if(P&&tp(R,P),t=R[0],e=R[1],r=R[2],n=R[3],o=R[4],p=R[9]=R[9]===i?d?0:t.length:at(R[9]-_,0),!p&&e&(ut|ot)&&(e&=~(ut|ot)),!e||e==ft)var O=Tl(t,e,r);else e==ut||e==ot?O=Ml(t,e,p):(e==bt||e==(ft|bt))&&!o.length?O=Vl(t,e,r,n):O=li.apply(i,R);var j=P?ja:po;return fo(j(O,R),t,e)}function ro(t,e,r,n){return t===i||Gt(t,Ge[r])&&!H.call(n,r)?e:t}function io(t,e,r,n,o,u){return Z(t)&&Z(e)&&(u.set(e,t),oi(t,e,i,io,u),u.delete(e)),t}function kl(t){return Pr(t)?i:t}function no(t,e,r,n,o,u){var l=r&nt,p=t.length,d=e.length;if(p!=d&&!(l&&d>p))return!1;var _=u.get(t),y=u.get(e);if(_&&y)return _==e&&y==t;var I=-1,P=!0,R=r&Kt?new Ce:i;for(u.set(t,e),u.set(e,t);++I<p;){var O=t[I],j=e[I];if(n)var D=l?n(j,O,I,e,t,u):n(O,j,I,t,e,u);if(D!==i){if(D)continue;P=!1;break}if(R){if(!tn(e,function(V,k){if(!hr(R,k)&&(O===V||o(O,V,r,n,u)))return R.push(k)})){P=!1;break}}else if(!(O===j||o(O,j,r,n,u))){P=!1;break}}return u.delete(t),u.delete(e),P}function Ll(t,e,r,n,o,u,l){switch(r){case Ue:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ur:return!(t.byteLength!=e.byteLength||!u(new Jr(t),new Jr(e)));case ir:case nr:case sr:return Gt(+t,+e);case jr:return t.name==e.name&&t.message==e.message;case ar:case or:return t==e+"";case Lt:var p=on;case zt:var d=n&nt;if(p||(p=Fr),t.size!=e.size&&!d)return!1;var _=l.get(t);if(_)return _==e;n|=Kt,l.set(t,e);var y=no(p(t),p(e),n,o,u,l);return l.delete(t),y;case Mr:if(gr)return gr.call(t)==gr.call(e)}return!1}function zl(t,e,r,n,o,u){var l=r&nt,p=qn(t),d=p.length,_=qn(e),y=_.length;if(d!=y&&!l)return!1;for(var I=d;I--;){var P=p[I];if(!(l?P in e:H.call(e,P)))return!1}var R=u.get(t),O=u.get(e);if(R&&O)return R==e&&O==t;var j=!0;u.set(t,e),u.set(e,t);for(var D=l;++I<d;){P=p[I];var V=t[P],k=e[P];if(n)var Nt=l?n(k,V,P,e,t,u):n(V,k,P,t,e,u);if(!(Nt===i?V===k||o(V,k,r,n,u):Nt)){j=!1;break}D||(D=P=="constructor")}if(j&&!D){var _t=t.constructor,At=e.constructor;_t!=At&&"constructor"in t&&"constructor"in e&&!(typeof _t=="function"&&_t instanceof _t&&typeof At=="function"&&At instanceof At)&&(j=!1)}return u.delete(t),u.delete(e),j}function ae(t){return kn(ho(t,i,wo),t+"")}function qn(t){return Pa(t,ct,Tn)}function xn(t){return Pa(t,It,so)}var $n=ei?function(t){return ei.get(t)}:Xn;function gi(t){for(var e=t.name+"",r=Be[e],n=H.call(Be,e)?r.length:0;n--;){var o=r[n],u=o.func;if(u==null||u==t)return o.name}return e}function Qe(t){var e=H.call(c,"placeholder")?c:t;return e.placeholder}function A(){var t=c.iteratee||Qn;return t=t===Qn?Ra:t,arguments.length?t(arguments[0],arguments[1]):t}function vi(t,e){var r=t.__data__;return Yl(e)?r[typeof e=="string"?"string":"hash"]:r.map}function jn(t){for(var e=ct(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,co(o)]}return e}function Ae(t,e){var r=Xu(t,e);return Ca(r)?r:i}function Fl(t){var e=H.call(t,Pe),r=t[Pe];try{t[Pe]=i;var n=!0}catch{}var o=Br.call(t);return n&&(e?t[Pe]=r:delete t[Pe]),o}var Tn=un?function(t){return t==null?[]:(t=W(t),pe(un(t),function(e){return la.call(t,e)}))}:ts,so=un?function(t){for(var e=[];t;)fe(e,Tn(t)),t=Yr(t);return e}:ts,gt=vt;(hn&&gt(new hn(new ArrayBuffer(1)))!=Ue||pr&&gt(new pr)!=Lt||ln&&gt(ln.resolve())!=Is||We&&gt(new We)!=zt||fr&&gt(new fr)!=cr)&&(gt=function(t){var e=vt(t),r=e==ee?t.constructor:i,n=r?Oe(r):"";if(n)switch(n){case Sh:return Ue;case Ch:return Lt;case Rh:return Is;case Nh:return zt;case Ah:return cr}return e});function Hl(t,e,r){for(var n=-1,o=r.length;++n<o;){var u=r[n],l=u.size;switch(u.type){case"drop":t+=l;break;case"dropRight":e-=l;break;case"take":e=dt(e,t+l);break;case"takeRight":t=at(t,e-l);break}}return{start:t,end:e}}function Gl(t){var e=t.match(Qc);return e?e[1].split(Zc):[]}function ao(t,e,r){e=_e(e,t);for(var n=-1,o=e.length,u=!1;++n<o;){var l=Zt(e[n]);if(!(u=t!=null&&r(t,l)))break;t=t[l]}return u||++n!=o?u:(o=t==null?0:t.length,!!o&&bi(o)&&oe(l,o)&&(x(t)||De(t)))}function Wl(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&H.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function oo(t){return typeof t.constructor=="function"&&!Er(t)?Ke(Yr(t)):{}}function Bl(t,e,r){var n=t.constructor;switch(e){case ur:return An(t);case ir:case nr:return new n(+t);case Ue:return Ol(t,r);case $i:case ji:case Ti:case Mi:case Vi:case Ui:case ki:case Li:case zi:return Fa(t,r);case Lt:return new n;case sr:case or:return new n(t);case ar:return Dl(t);case zt:return new n;case Mr:return ql(t)}}function Kl(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(Yc,`{
/* [wrapped with `+e+`] */
`)}function Jl(t){return x(t)||De(t)||!!(pa&&t&&t[pa])}function oe(t,e){var r=typeof t;return e=e??le,!!e&&(r=="number"||r!="symbol"&&ou.test(t))&&t>-1&&t%1==0&&t<e}function mt(t,e,r){if(!Z(r))return!1;var n=typeof e;return(n=="number"?wt(r)&&oe(e,r.length):n=="string"&&e in r)?Gt(r[e],t):!1}function Mn(t,e){if(x(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Rt(t)?!0:Wc.test(t)||!Gc.test(t)||e!=null&&t in W(e)}function Yl(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Vn(t){var e=gi(t),r=c[e];if(typeof r!="function"||!(e in U.prototype))return!1;if(t===r)return!0;var n=$n(r);return!!n&&t===n[0]}function Ql(t){return!!ca&&ca in t}var Zl=Gr?ce:es;function Er(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Ge;return t===r}function co(t){return t===t&&!Z(t)}function uo(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==i||t in W(r))}}function Xl(t){var e=Ii(t,function(n){return r.size===N&&r.clear(),n}),r=e.cache;return e}function tp(t,e){var r=t[1],n=e[1],o=r|n,u=o<(ft|Ot|te),l=n==te&&r==ut||n==te&&r==rr&&t[7].length<=e[8]||n==(te|rr)&&e[7].length<=e[8]&&r==ut;if(!(u||l))return t;n&ft&&(t[2]=e[2],o|=r&ft?0:qr);var p=e[3];if(p){var d=t[3];t[3]=d?Ga(d,p,e[4]):p,t[4]=d?de(t[3],F):e[4]}return p=e[5],p&&(d=t[5],t[5]=d?Wa(d,p,e[6]):p,t[6]=d?de(t[5],F):e[6]),p=e[7],p&&(t[7]=p),n&te&&(t[8]=t[8]==null?e[8]:dt(t[8],e[8])),t[9]==null&&(t[9]=e[9]),t[0]=e[0],t[1]=o,t}function ep(t){var e=[];if(t!=null)for(var r in W(t))e.push(r);return e}function rp(t){return Br.call(t)}function ho(t,e,r){return e=at(e===i?t.length-1:e,0),function(){for(var n=arguments,o=-1,u=at(n.length-e,0),l=v(u);++o<u;)l[o]=n[e+o];o=-1;for(var p=v(e+1);++o<e;)p[o]=n[o];return p[e]=r(l),Pt(t,this,p)}}function lo(t,e){return e.length<2?t:Ne(t,Tt(e,0,-1))}function ip(t,e){for(var r=t.length,n=dt(e.length,r),o=yt(t);n--;){var u=e[n];t[n]=oe(u,r)?o[u]:i}return t}function Un(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var po=go(ja),br=_h||function(t,e){return ht.setTimeout(t,e)},kn=go(Cl);function fo(t,e,r){var n=e+"";return kn(t,Kl(n,np(Gl(n),r)))}function go(t){var e=0,r=0;return function(){var n=Eh(),o=Sc-(n-r);if(r=n,o>0){if(++e>=Pc)return arguments[0]}else e=0;return t.apply(i,arguments)}}function mi(t,e){var r=-1,n=t.length,o=n-1;for(e=e===i?n:e;++r<e;){var u=En(r,o),l=t[u];t[u]=t[r],t[r]=l}return t.length=e,t}var vo=Xl(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Bc,function(r,n,o,u){e.push(o?u.replace(eu,"$1"):n||r)}),e});function Zt(t){if(typeof t=="string"||Rt(t))return t;var e=t+"";return e=="0"&&1/t==-Ee?"-0":e}function Oe(t){if(t!=null){try{return Wr.call(t)}catch{}try{return t+""}catch{}}return""}function np(t,e){return qt(Dc,function(r){var n="_."+r[0];e&r[1]&&!Lr(t,n)&&t.push(n)}),t.sort()}function mo(t){if(t instanceof U)return t.clone();var e=new $t(t.__wrapped__,t.__chain__);return e.__actions__=yt(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function sp(t,e,r){(r?mt(t,e,r):e===i)?e=1:e=at($(e),0);var n=t==null?0:t.length;if(!n||e<1)return[];for(var o=0,u=0,l=v(Xr(n/e));o<n;)l[u++]=Tt(t,o,o+=e);return l}function ap(t){for(var e=-1,r=t==null?0:t.length,n=0,o=[];++e<r;){var u=t[e];u&&(o[n++]=u)}return o}function op(){var t=arguments.length;if(!t)return[];for(var e=v(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return fe(x(r)?yt(r):[r],lt(e,1))}var cp=M(function(t,e){return et(t)?mr(t,lt(e,1,et,!0)):[]}),up=M(function(t,e){var r=Mt(e);return et(r)&&(r=i),et(t)?mr(t,lt(e,1,et,!0),A(r,2)):[]}),hp=M(function(t,e){var r=Mt(e);return et(r)&&(r=i),et(t)?mr(t,lt(e,1,et,!0),i,r):[]});function lp(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===i?1:$(e),Tt(t,e<0?0:e,n)):[]}function pp(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===i?1:$(e),e=n-e,Tt(t,0,e<0?0:e)):[]}function fp(t,e){return t&&t.length?ui(t,A(e,3),!0,!0):[]}function dp(t,e){return t&&t.length?ui(t,A(e,3),!0):[]}function gp(t,e,r,n){var o=t==null?0:t.length;return o?(r&&typeof r!="number"&&mt(t,e,r)&&(r=0,n=o),ol(t,e,r,n)):[]}function _o(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var o=r==null?0:$(r);return o<0&&(o=at(n+o,0)),zr(t,A(e,3),o)}function yo(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var o=n-1;return r!==i&&(o=$(r),o=r<0?at(n+o,0):dt(o,n-1)),zr(t,A(e,3),o,!0)}function wo(t){var e=t==null?0:t.length;return e?lt(t,1):[]}function vp(t){var e=t==null?0:t.length;return e?lt(t,Ee):[]}function mp(t,e){var r=t==null?0:t.length;return r?(e=e===i?1:$(e),lt(t,e)):[]}function _p(t){for(var e=-1,r=t==null?0:t.length,n={};++e<r;){var o=t[e];n[o[0]]=o[1]}return n}function Io(t){return t&&t.length?t[0]:i}function yp(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var o=r==null?0:$(r);return o<0&&(o=at(n+o,0)),Le(t,e,o)}function wp(t){var e=t==null?0:t.length;return e?Tt(t,0,-1):[]}var Ip=M(function(t){var e=J(t,Rn);return e.length&&e[0]===t[0]?mn(e):[]}),Ep=M(function(t){var e=Mt(t),r=J(t,Rn);return e===Mt(r)?e=i:r.pop(),r.length&&r[0]===t[0]?mn(r,A(e,2)):[]}),bp=M(function(t){var e=Mt(t),r=J(t,Rn);return e=typeof e=="function"?e:i,e&&r.pop(),r.length&&r[0]===t[0]?mn(r,i,e):[]});function Pp(t,e){return t==null?"":wh.call(t,e)}function Mt(t){var e=t==null?0:t.length;return e?t[e-1]:i}function Sp(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var o=n;return r!==i&&(o=$(r),o=o<0?at(n+o,0):dt(o,n-1)),e===e?nh(t,e,o):zr(t,ta,o,!0)}function Cp(t,e){return t&&t.length?Da(t,$(e)):i}var Rp=M(Eo);function Eo(t,e){return t&&t.length&&e&&e.length?In(t,e):t}function Np(t,e,r){return t&&t.length&&e&&e.length?In(t,e,A(r,2)):t}function Ap(t,e,r){return t&&t.length&&e&&e.length?In(t,e,i,r):t}var Op=ae(function(t,e){var r=t==null?0:t.length,n=fn(t,e);return $a(t,J(e,function(o){return oe(o,r)?+o:o}).sort(Ha)),n});function Dp(t,e){var r=[];if(!(t&&t.length))return r;var n=-1,o=[],u=t.length;for(e=A(e,3);++n<u;){var l=t[n];e(l,n,t)&&(r.push(l),o.push(n))}return $a(t,o),r}function Ln(t){return t==null?t:Ph.call(t)}function qp(t,e,r){var n=t==null?0:t.length;return n?(r&&typeof r!="number"&&mt(t,e,r)?(e=0,r=n):(e=e==null?0:$(e),r=r===i?n:$(r)),Tt(t,e,r)):[]}function xp(t,e){return ci(t,e)}function $p(t,e,r){return Pn(t,e,A(r,2))}function jp(t,e){var r=t==null?0:t.length;if(r){var n=ci(t,e);if(n<r&&Gt(t[n],e))return n}return-1}function Tp(t,e){return ci(t,e,!0)}function Mp(t,e,r){return Pn(t,e,A(r,2),!0)}function Vp(t,e){var r=t==null?0:t.length;if(r){var n=ci(t,e,!0)-1;if(Gt(t[n],e))return n}return-1}function Up(t){return t&&t.length?Ta(t):[]}function kp(t,e){return t&&t.length?Ta(t,A(e,2)):[]}function Lp(t){var e=t==null?0:t.length;return e?Tt(t,1,e):[]}function zp(t,e,r){return t&&t.length?(e=r||e===i?1:$(e),Tt(t,0,e<0?0:e)):[]}function Fp(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===i?1:$(e),e=n-e,Tt(t,e<0?0:e,n)):[]}function Hp(t,e){return t&&t.length?ui(t,A(e,3),!1,!0):[]}function Gp(t,e){return t&&t.length?ui(t,A(e,3)):[]}var Wp=M(function(t){return me(lt(t,1,et,!0))}),Bp=M(function(t){var e=Mt(t);return et(e)&&(e=i),me(lt(t,1,et,!0),A(e,2))}),Kp=M(function(t){var e=Mt(t);return e=typeof e=="function"?e:i,me(lt(t,1,et,!0),i,e)});function Jp(t){return t&&t.length?me(t):[]}function Yp(t,e){return t&&t.length?me(t,A(e,2)):[]}function Qp(t,e){return e=typeof e=="function"?e:i,t&&t.length?me(t,i,e):[]}function zn(t){if(!(t&&t.length))return[];var e=0;return t=pe(t,function(r){if(et(r))return e=at(r.length,e),!0}),sn(e,function(r){return J(t,en(r))})}function bo(t,e){if(!(t&&t.length))return[];var r=zn(t);return e==null?r:J(r,function(n){return Pt(e,i,n)})}var Zp=M(function(t,e){return et(t)?mr(t,e):[]}),Xp=M(function(t){return Cn(pe(t,et))}),tf=M(function(t){var e=Mt(t);return et(e)&&(e=i),Cn(pe(t,et),A(e,2))}),ef=M(function(t){var e=Mt(t);return e=typeof e=="function"?e:i,Cn(pe(t,et),i,e)}),rf=M(zn);function nf(t,e){return ka(t||[],e||[],vr)}function sf(t,e){return ka(t||[],e||[],wr)}var af=M(function(t){var e=t.length,r=e>1?t[e-1]:i;return r=typeof r=="function"?(t.pop(),r):i,bo(t,r)});function Po(t){var e=c(t);return e.__chain__=!0,e}function of(t,e){return e(t),t}function _i(t,e){return e(t)}var cf=ae(function(t){var e=t.length,r=e?t[0]:0,n=this.__wrapped__,o=function(u){return fn(u,t)};return e>1||this.__actions__.length||!(n instanceof U)||!oe(r)?this.thru(o):(n=n.slice(r,+r+(e?1:0)),n.__actions__.push({func:_i,args:[o],thisArg:i}),new $t(n,this.__chain__).thru(function(u){return e&&!u.length&&u.push(i),u}))});function uf(){return Po(this)}function hf(){return new $t(this.value(),this.__chain__)}function lf(){this.__values__===i&&(this.__values__=Vo(this.value()));var t=this.__index__>=this.__values__.length,e=t?i:this.__values__[this.__index__++];return{done:t,value:e}}function pf(){return this}function ff(t){for(var e,r=this;r instanceof ii;){var n=mo(r);n.__index__=0,n.__values__=i,e?o.__wrapped__=n:e=n;var o=n;r=r.__wrapped__}return o.__wrapped__=t,e}function df(){var t=this.__wrapped__;if(t instanceof U){var e=t;return this.__actions__.length&&(e=new U(this)),e=e.reverse(),e.__actions__.push({func:_i,args:[Ln],thisArg:i}),new $t(e,this.__chain__)}return this.thru(Ln)}function gf(){return Ua(this.__wrapped__,this.__actions__)}var vf=hi(function(t,e,r){H.call(t,r)?++t[r]:ne(t,r,1)});function mf(t,e,r){var n=x(t)?Zs:al;return r&&mt(t,e,r)&&(e=i),n(t,A(e,3))}function _f(t,e){var r=x(t)?pe:Ea;return r(t,A(e,3))}var yf=Ya(_o),wf=Ya(yo);function If(t,e){return lt(yi(t,e),1)}function Ef(t,e){return lt(yi(t,e),Ee)}function bf(t,e,r){return r=r===i?1:$(r),lt(yi(t,e),r)}function So(t,e){var r=x(t)?qt:ve;return r(t,A(e,3))}function Co(t,e){var r=x(t)?Lu:Ia;return r(t,A(e,3))}var Pf=hi(function(t,e,r){H.call(t,r)?t[r].push(e):ne(t,r,[e])});function Sf(t,e,r,n){t=wt(t)?t:Xe(t),r=r&&!n?$(r):0;var o=t.length;return r<0&&(r=at(o+r,0)),Pi(t)?r<=o&&t.indexOf(e,r)>-1:!!o&&Le(t,e,r)>-1}var Cf=M(function(t,e,r){var n=-1,o=typeof e=="function",u=wt(t)?v(t.length):[];return ve(t,function(l){u[++n]=o?Pt(e,l,r):_r(l,e,r)}),u}),Rf=hi(function(t,e,r){ne(t,r,e)});function yi(t,e){var r=x(t)?J:Na;return r(t,A(e,3))}function Nf(t,e,r,n){return t==null?[]:(x(e)||(e=e==null?[]:[e]),r=n?i:r,x(r)||(r=r==null?[]:[r]),qa(t,e,r))}var Af=hi(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]});function Of(t,e,r){var n=x(t)?Xi:ra,o=arguments.length<3;return n(t,A(e,4),r,o,ve)}function Df(t,e,r){var n=x(t)?zu:ra,o=arguments.length<3;return n(t,A(e,4),r,o,Ia)}function qf(t,e){var r=x(t)?pe:Ea;return r(t,Ei(A(e,3)))}function xf(t){var e=x(t)?ma:Pl;return e(t)}function $f(t,e,r){(r?mt(t,e,r):e===i)?e=1:e=$(e);var n=x(t)?el:Sl;return n(t,e)}function jf(t){var e=x(t)?rl:Rl;return e(t)}function Tf(t){if(t==null)return 0;if(wt(t))return Pi(t)?Fe(t):t.length;var e=gt(t);return e==Lt||e==zt?t.size:yn(t).length}function Mf(t,e,r){var n=x(t)?tn:Nl;return r&&mt(t,e,r)&&(e=i),n(t,A(e,3))}var Vf=M(function(t,e){if(t==null)return[];var r=e.length;return r>1&&mt(t,e[0],e[1])?e=[]:r>2&&mt(e[0],e[1],e[2])&&(e=[e[0]]),qa(t,lt(e,1),[])}),wi=mh||function(){return ht.Date.now()};function Uf(t,e){if(typeof e!="function")throw new xt(w);return t=$(t),function(){if(--t<1)return e.apply(this,arguments)}}function Ro(t,e,r){return e=r?i:e,e=t&&e==null?t.length:e,se(t,te,i,i,i,i,e)}function No(t,e){var r;if(typeof e!="function")throw new xt(w);return t=$(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=i),r}}var Fn=M(function(t,e,r){var n=ft;if(r.length){var o=de(r,Qe(Fn));n|=bt}return se(t,n,e,r,o)}),Ao=M(function(t,e,r){var n=ft|Ot;if(r.length){var o=de(r,Qe(Ao));n|=bt}return se(e,n,t,r,o)});function Oo(t,e,r){e=r?i:e;var n=se(t,ut,i,i,i,i,i,e);return n.placeholder=Oo.placeholder,n}function Do(t,e,r){e=r?i:e;var n=se(t,ot,i,i,i,i,i,e);return n.placeholder=Do.placeholder,n}function qo(t,e,r){var n,o,u,l,p,d,_=0,y=!1,I=!1,P=!0;if(typeof t!="function")throw new xt(w);e=Vt(e)||0,Z(r)&&(y=!!r.leading,I="maxWait"in r,u=I?at(Vt(r.maxWait)||0,e):u,P="trailing"in r?!!r.trailing:P);function R(rt){var Wt=n,he=o;return n=o=i,_=rt,l=t.apply(he,Wt),l}function O(rt){return _=rt,p=br(V,e),y?R(rt):l}function j(rt){var Wt=rt-d,he=rt-_,Qo=e-Wt;return I?dt(Qo,u-he):Qo}function D(rt){var Wt=rt-d,he=rt-_;return d===i||Wt>=e||Wt<0||I&&he>=u}function V(){var rt=wi();if(D(rt))return k(rt);p=br(V,j(rt))}function k(rt){return p=i,P&&n?R(rt):(n=o=i,l)}function Nt(){p!==i&&La(p),_=0,n=d=o=p=i}function _t(){return p===i?l:k(wi())}function At(){var rt=wi(),Wt=D(rt);if(n=arguments,o=this,d=rt,Wt){if(p===i)return O(d);if(I)return La(p),p=br(V,e),R(d)}return p===i&&(p=br(V,e)),l}return At.cancel=Nt,At.flush=_t,At}var kf=M(function(t,e){return wa(t,1,e)}),Lf=M(function(t,e,r){return wa(t,Vt(e)||0,r)});function zf(t){return se(t,xi)}function Ii(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new xt(w);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],u=r.cache;if(u.has(o))return u.get(o);var l=t.apply(this,n);return r.cache=u.set(o,l)||u,l};return r.cache=new(Ii.Cache||ie),r}Ii.Cache=ie;function Ei(t){if(typeof t!="function")throw new xt(w);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Ff(t){return No(2,t)}var Hf=Al(function(t,e){e=e.length==1&&x(e[0])?J(e[0],St(A())):J(lt(e,1),St(A()));var r=e.length;return M(function(n){for(var o=-1,u=dt(n.length,r);++o<u;)n[o]=e[o].call(this,n[o]);return Pt(t,this,n)})}),Hn=M(function(t,e){var r=de(e,Qe(Hn));return se(t,bt,i,e,r)}),xo=M(function(t,e){var r=de(e,Qe(xo));return se(t,Me,i,e,r)}),Gf=ae(function(t,e){return se(t,rr,i,i,i,e)});function Wf(t,e){if(typeof t!="function")throw new xt(w);return e=e===i?e:$(e),M(t,e)}function Bf(t,e){if(typeof t!="function")throw new xt(w);return e=e==null?0:at($(e),0),M(function(r){var n=r[e],o=ye(r,0,e);return n&&fe(o,n),Pt(t,this,o)})}function Kf(t,e,r){var n=!0,o=!0;if(typeof t!="function")throw new xt(w);return Z(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),qo(t,e,{leading:n,maxWait:e,trailing:o})}function Jf(t){return Ro(t,1)}function Yf(t,e){return Hn(Nn(e),t)}function Qf(){if(!arguments.length)return[];var t=arguments[0];return x(t)?t:[t]}function Zf(t){return jt(t,Q)}function Xf(t,e){return e=typeof e=="function"?e:i,jt(t,Q,e)}function td(t){return jt(t,Y|Q)}function ed(t,e){return e=typeof e=="function"?e:i,jt(t,Y|Q,e)}function rd(t,e){return e==null||ya(t,e,ct(e))}function Gt(t,e){return t===e||t!==t&&e!==e}var id=di(vn),nd=di(function(t,e){return t>=e}),De=Sa(function(){return arguments}())?Sa:function(t){return X(t)&&H.call(t,"callee")&&!la.call(t,"callee")},x=v.isArray,sd=Ws?St(Ws):pl;function wt(t){return t!=null&&bi(t.length)&&!ce(t)}function et(t){return X(t)&&wt(t)}function ad(t){return t===!0||t===!1||X(t)&&vt(t)==ir}var we=yh||es,od=Bs?St(Bs):fl;function cd(t){return X(t)&&t.nodeType===1&&!Pr(t)}function ud(t){if(t==null)return!0;if(wt(t)&&(x(t)||typeof t=="string"||typeof t.splice=="function"||we(t)||Ze(t)||De(t)))return!t.length;var e=gt(t);if(e==Lt||e==zt)return!t.size;if(Er(t))return!yn(t).length;for(var r in t)if(H.call(t,r))return!1;return!0}function hd(t,e){return yr(t,e)}function ld(t,e,r){r=typeof r=="function"?r:i;var n=r?r(t,e):i;return n===i?yr(t,e,i,r):!!n}function Gn(t){if(!X(t))return!1;var e=vt(t);return e==jr||e==xc||typeof t.message=="string"&&typeof t.name=="string"&&!Pr(t)}function pd(t){return typeof t=="number"&&fa(t)}function ce(t){if(!Z(t))return!1;var e=vt(t);return e==Tr||e==ws||e==qc||e==jc}function $o(t){return typeof t=="number"&&t==$(t)}function bi(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=le}function Z(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function X(t){return t!=null&&typeof t=="object"}var jo=Ks?St(Ks):gl;function fd(t,e){return t===e||_n(t,e,jn(e))}function dd(t,e,r){return r=typeof r=="function"?r:i,_n(t,e,jn(e),r)}function gd(t){return To(t)&&t!=+t}function vd(t){if(Zl(t))throw new q(g);return Ca(t)}function md(t){return t===null}function _d(t){return t==null}function To(t){return typeof t=="number"||X(t)&&vt(t)==sr}function Pr(t){if(!X(t)||vt(t)!=ee)return!1;var e=Yr(t);if(e===null)return!0;var r=H.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Wr.call(r)==fh}var Wn=Js?St(Js):vl;function yd(t){return $o(t)&&t>=-le&&t<=le}var Mo=Ys?St(Ys):ml;function Pi(t){return typeof t=="string"||!x(t)&&X(t)&&vt(t)==or}function Rt(t){return typeof t=="symbol"||X(t)&&vt(t)==Mr}var Ze=Qs?St(Qs):_l;function wd(t){return t===i}function Id(t){return X(t)&&gt(t)==cr}function Ed(t){return X(t)&&vt(t)==Mc}var bd=di(wn),Pd=di(function(t,e){return t<=e});function Vo(t){if(!t)return[];if(wt(t))return Pi(t)?Ft(t):yt(t);if(lr&&t[lr])return eh(t[lr]());var e=gt(t),r=e==Lt?on:e==zt?Fr:Xe;return r(t)}function ue(t){if(!t)return t===0?t:0;if(t=Vt(t),t===Ee||t===-Ee){var e=t<0?-1:1;return e*Nc}return t===t?t:0}function $(t){var e=ue(t),r=e%1;return e===e?r?e-r:e:0}function Uo(t){return t?Re($(t),0,Jt):0}function Vt(t){if(typeof t=="number")return t;if(Rt(t))return xr;if(Z(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Z(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ia(t);var r=nu.test(t);return r||au.test(t)?Vu(t.slice(2),r?2:8):iu.test(t)?xr:+t}function ko(t){return Qt(t,It(t))}function Sd(t){return t?Re($(t),-le,le):t===0?t:0}function z(t){return t==null?"":Ct(t)}var Cd=Je(function(t,e){if(Er(e)||wt(e)){Qt(e,ct(e),t);return}for(var r in e)H.call(e,r)&&vr(t,r,e[r])}),Lo=Je(function(t,e){Qt(e,It(e),t)}),Si=Je(function(t,e,r,n){Qt(e,It(e),t,n)}),Rd=Je(function(t,e,r,n){Qt(e,ct(e),t,n)}),Nd=ae(fn);function Ad(t,e){var r=Ke(t);return e==null?r:_a(r,e)}var Od=M(function(t,e){t=W(t);var r=-1,n=e.length,o=n>2?e[2]:i;for(o&&mt(e[0],e[1],o)&&(n=1);++r<n;)for(var u=e[r],l=It(u),p=-1,d=l.length;++p<d;){var _=l[p],y=t[_];(y===i||Gt(y,Ge[_])&&!H.call(t,_))&&(t[_]=u[_])}return t}),Dd=M(function(t){return t.push(i,io),Pt(zo,i,t)});function qd(t,e){return Xs(t,A(e,3),Yt)}function xd(t,e){return Xs(t,A(e,3),gn)}function $d(t,e){return t==null?t:dn(t,A(e,3),It)}function jd(t,e){return t==null?t:ba(t,A(e,3),It)}function Td(t,e){return t&&Yt(t,A(e,3))}function Md(t,e){return t&&gn(t,A(e,3))}function Vd(t){return t==null?[]:ai(t,ct(t))}function Ud(t){return t==null?[]:ai(t,It(t))}function Bn(t,e,r){var n=t==null?i:Ne(t,e);return n===i?r:n}function kd(t,e){return t!=null&&ao(t,e,cl)}function Kn(t,e){return t!=null&&ao(t,e,ul)}var Ld=Za(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=Br.call(e)),t[e]=r},Yn(Et)),zd=Za(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=Br.call(e)),H.call(t,e)?t[e].push(r):t[e]=[r]},A),Fd=M(_r);function ct(t){return wt(t)?va(t):yn(t)}function It(t){return wt(t)?va(t,!0):yl(t)}function Hd(t,e){var r={};return e=A(e,3),Yt(t,function(n,o,u){ne(r,e(n,o,u),n)}),r}function Gd(t,e){var r={};return e=A(e,3),Yt(t,function(n,o,u){ne(r,o,e(n,o,u))}),r}var Wd=Je(function(t,e,r){oi(t,e,r)}),zo=Je(function(t,e,r,n){oi(t,e,r,n)}),Bd=ae(function(t,e){var r={};if(t==null)return r;var n=!1;e=J(e,function(u){return u=_e(u,t),n||(n=u.length>1),u}),Qt(t,xn(t),r),n&&(r=jt(r,Y|G|Q,kl));for(var o=e.length;o--;)Sn(r,e[o]);return r});function Kd(t,e){return Fo(t,Ei(A(e)))}var Jd=ae(function(t,e){return t==null?{}:Il(t,e)});function Fo(t,e){if(t==null)return{};var r=J(xn(t),function(n){return[n]});return e=A(e),xa(t,r,function(n,o){return e(n,o[0])})}function Yd(t,e,r){e=_e(e,t);var n=-1,o=e.length;for(o||(o=1,t=i);++n<o;){var u=t==null?i:t[Zt(e[n])];u===i&&(n=o,u=r),t=ce(u)?u.call(t):u}return t}function Qd(t,e,r){return t==null?t:wr(t,e,r)}function Zd(t,e,r,n){return n=typeof n=="function"?n:i,t==null?t:wr(t,e,r,n)}var Ho=eo(ct),Go=eo(It);function Xd(t,e,r){var n=x(t),o=n||we(t)||Ze(t);if(e=A(e,4),r==null){var u=t&&t.constructor;o?r=n?new u:[]:Z(t)?r=ce(u)?Ke(Yr(t)):{}:r={}}return(o?qt:Yt)(t,function(l,p,d){return e(r,l,p,d)}),r}function tg(t,e){return t==null?!0:Sn(t,e)}function eg(t,e,r){return t==null?t:Va(t,e,Nn(r))}function rg(t,e,r,n){return n=typeof n=="function"?n:i,t==null?t:Va(t,e,Nn(r),n)}function Xe(t){return t==null?[]:an(t,ct(t))}function ig(t){return t==null?[]:an(t,It(t))}function ng(t,e,r){return r===i&&(r=e,e=i),r!==i&&(r=Vt(r),r=r===r?r:0),e!==i&&(e=Vt(e),e=e===e?e:0),Re(Vt(t),e,r)}function sg(t,e,r){return e=ue(e),r===i?(r=e,e=0):r=ue(r),t=Vt(t),hl(t,e,r)}function ag(t,e,r){if(r&&typeof r!="boolean"&&mt(t,e,r)&&(e=r=i),r===i&&(typeof e=="boolean"?(r=e,e=i):typeof t=="boolean"&&(r=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ue(t),e===i?(e=t,t=0):e=ue(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var o=da();return dt(t+o*(e-t+Mu("1e-"+((o+"").length-1))),e)}return En(t,e)}var og=Ye(function(t,e,r){return e=e.toLowerCase(),t+(r?Wo(e):e)});function Wo(t){return Jn(z(t).toLowerCase())}function Bo(t){return t=z(t),t&&t.replace(cu,Yu).replace(Ru,"")}function cg(t,e,r){t=z(t),e=Ct(e);var n=t.length;r=r===i?n:Re($(r),0,n);var o=r;return r-=e.length,r>=0&&t.slice(r,o)==e}function ug(t){return t=z(t),t&&zc.test(t)?t.replace(bs,Qu):t}function hg(t){return t=z(t),t&&Kc.test(t)?t.replace(Fi,"\\$&"):t}var lg=Ye(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),pg=Ye(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),fg=Ja("toLowerCase");function dg(t,e,r){t=z(t),e=$(e);var n=e?Fe(t):0;if(!e||n>=e)return t;var o=(e-n)/2;return fi(ti(o),r)+t+fi(Xr(o),r)}function gg(t,e,r){t=z(t),e=$(e);var n=e?Fe(t):0;return e&&n<e?t+fi(e-n,r):t}function vg(t,e,r){t=z(t),e=$(e);var n=e?Fe(t):0;return e&&n<e?fi(e-n,r)+t:t}function mg(t,e,r){return r||e==null?e=0:e&&(e=+e),bh(z(t).replace(Hi,""),e||0)}function _g(t,e,r){return(r?mt(t,e,r):e===i)?e=1:e=$(e),bn(z(t),e)}function yg(){var t=arguments,e=z(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var wg=Ye(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()});function Ig(t,e,r){return r&&typeof r!="number"&&mt(t,e,r)&&(e=r=i),r=r===i?Jt:r>>>0,r?(t=z(t),t&&(typeof e=="string"||e!=null&&!Wn(e))&&(e=Ct(e),!e&&ze(t))?ye(Ft(t),0,r):t.split(e,r)):[]}var Eg=Ye(function(t,e,r){return t+(r?" ":"")+Jn(e)});function bg(t,e,r){return t=z(t),r=r==null?0:Re($(r),0,t.length),e=Ct(e),t.slice(r,r+e.length)==e}function Pg(t,e,r){var n=c.templateSettings;r&&mt(t,e,r)&&(e=i),t=z(t),e=Si({},e,n,ro);var o=Si({},e.imports,n.imports,ro),u=ct(o),l=an(o,u),p,d,_=0,y=e.interpolate||Vr,I="__p += '",P=cn((e.escape||Vr).source+"|"+y.source+"|"+(y===Ps?ru:Vr).source+"|"+(e.evaluate||Vr).source+"|$","g"),R="//# sourceURL="+(H.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qu+"]")+`
`;t.replace(P,function(D,V,k,Nt,_t,At){return k||(k=Nt),I+=t.slice(_,At).replace(uu,Zu),V&&(p=!0,I+=`' +
__e(`+V+`) +
'`),_t&&(d=!0,I+=`';
`+_t+`;
__p += '`),k&&(I+=`' +
((__t = (`+k+`)) == null ? '' : __t) +
'`),_=At+D.length,D}),I+=`';
`;var O=H.call(e,"variable")&&e.variable;if(!O)I=`with (obj) {
`+I+`
}
`;else if(tu.test(O))throw new q(b);I=(d?I.replace(Vc,""):I).replace(Uc,"$1").replace(kc,"$1;"),I="function("+(O||"obj")+`) {
`+(O?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(p?", __e = _.escape":"")+(d?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+I+`return __p
}`;var j=Jo(function(){return L(u,R+"return "+I).apply(i,l)});if(j.source=I,Gn(j))throw j;return j}function Sg(t){return z(t).toLowerCase()}function Cg(t){return z(t).toUpperCase()}function Rg(t,e,r){if(t=z(t),t&&(r||e===i))return ia(t);if(!t||!(e=Ct(e)))return t;var n=Ft(t),o=Ft(e),u=na(n,o),l=sa(n,o)+1;return ye(n,u,l).join("")}function Ng(t,e,r){if(t=z(t),t&&(r||e===i))return t.slice(0,oa(t)+1);if(!t||!(e=Ct(e)))return t;var n=Ft(t),o=sa(n,Ft(e))+1;return ye(n,0,o).join("")}function Ag(t,e,r){if(t=z(t),t&&(r||e===i))return t.replace(Hi,"");if(!t||!(e=Ct(e)))return t;var n=Ft(t),o=na(n,Ft(e));return ye(n,o).join("")}function Og(t,e){var r=Ec,n=bc;if(Z(e)){var o="separator"in e?e.separator:o;r="length"in e?$(e.length):r,n="omission"in e?Ct(e.omission):n}t=z(t);var u=t.length;if(ze(t)){var l=Ft(t);u=l.length}if(r>=u)return t;var p=r-Fe(n);if(p<1)return n;var d=l?ye(l,0,p).join(""):t.slice(0,p);if(o===i)return d+n;if(l&&(p+=d.length-p),Wn(o)){if(t.slice(p).search(o)){var _,y=d;for(o.global||(o=cn(o.source,z(Ss.exec(o))+"g")),o.lastIndex=0;_=o.exec(y);)var I=_.index;d=d.slice(0,I===i?p:I)}}else if(t.indexOf(Ct(o),p)!=p){var P=d.lastIndexOf(o);P>-1&&(d=d.slice(0,P))}return d+n}function Dg(t){return t=z(t),t&&Lc.test(t)?t.replace(Es,sh):t}var qg=Ye(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),Jn=Ja("toUpperCase");function Ko(t,e,r){return t=z(t),e=r?i:e,e===i?th(t)?ch(t):Gu(t):t.match(e)||[]}var Jo=M(function(t,e){try{return Pt(t,i,e)}catch(r){return Gn(r)?r:new q(r)}}),xg=ae(function(t,e){return qt(e,function(r){r=Zt(r),ne(t,r,Fn(t[r],t))}),t});function $g(t){var e=t==null?0:t.length,r=A();return t=e?J(t,function(n){if(typeof n[1]!="function")throw new xt(w);return[r(n[0]),n[1]]}):[],M(function(n){for(var o=-1;++o<e;){var u=t[o];if(Pt(u[0],this,n))return Pt(u[1],this,n)}})}function jg(t){return sl(jt(t,Y))}function Yn(t){return function(){return t}}function Tg(t,e){return t==null||t!==t?e:t}var Mg=Qa(),Vg=Qa(!0);function Et(t){return t}function Qn(t){return Ra(typeof t=="function"?t:jt(t,Y))}function Ug(t){return Aa(jt(t,Y))}function kg(t,e){return Oa(t,jt(e,Y))}var Lg=M(function(t,e){return function(r){return _r(r,t,e)}}),zg=M(function(t,e){return function(r){return _r(t,r,e)}});function Zn(t,e,r){var n=ct(e),o=ai(e,n);r==null&&!(Z(e)&&(o.length||!n.length))&&(r=e,e=t,t=this,o=ai(e,ct(e)));var u=!(Z(r)&&"chain"in r)||!!r.chain,l=ce(t);return qt(o,function(p){var d=e[p];t[p]=d,l&&(t.prototype[p]=function(){var _=this.__chain__;if(u||_){var y=t(this.__wrapped__),I=y.__actions__=yt(this.__actions__);return I.push({func:d,args:arguments,thisArg:t}),y.__chain__=_,y}return d.apply(t,fe([this.value()],arguments))})}),t}function Fg(){return ht._===this&&(ht._=dh),this}function Xn(){}function Hg(t){return t=$(t),M(function(e){return Da(e,t)})}var Gg=On(J),Wg=On(Zs),Bg=On(tn);function Yo(t){return Mn(t)?en(Zt(t)):El(t)}function Kg(t){return function(e){return t==null?i:Ne(t,e)}}var Jg=Xa(),Yg=Xa(!0);function ts(){return[]}function es(){return!1}function Qg(){return{}}function Zg(){return""}function Xg(){return!0}function tv(t,e){if(t=$(t),t<1||t>le)return[];var r=Jt,n=dt(t,Jt);e=A(e),t-=Jt;for(var o=sn(n,e);++r<t;)e(r);return o}function ev(t){return x(t)?J(t,Zt):Rt(t)?[t]:yt(vo(z(t)))}function rv(t){var e=++ph;return z(t)+e}var iv=pi(function(t,e){return t+e},0),nv=Dn("ceil"),sv=pi(function(t,e){return t/e},1),av=Dn("floor");function ov(t){return t&&t.length?si(t,Et,vn):i}function cv(t,e){return t&&t.length?si(t,A(e,2),vn):i}function uv(t){return ea(t,Et)}function hv(t,e){return ea(t,A(e,2))}function lv(t){return t&&t.length?si(t,Et,wn):i}function pv(t,e){return t&&t.length?si(t,A(e,2),wn):i}var fv=pi(function(t,e){return t*e},1),dv=Dn("round"),gv=pi(function(t,e){return t-e},0);function vv(t){return t&&t.length?nn(t,Et):0}function mv(t,e){return t&&t.length?nn(t,A(e,2)):0}return c.after=Uf,c.ary=Ro,c.assign=Cd,c.assignIn=Lo,c.assignInWith=Si,c.assignWith=Rd,c.at=Nd,c.before=No,c.bind=Fn,c.bindAll=xg,c.bindKey=Ao,c.castArray=Qf,c.chain=Po,c.chunk=sp,c.compact=ap,c.concat=op,c.cond=$g,c.conforms=jg,c.constant=Yn,c.countBy=vf,c.create=Ad,c.curry=Oo,c.curryRight=Do,c.debounce=qo,c.defaults=Od,c.defaultsDeep=Dd,c.defer=kf,c.delay=Lf,c.difference=cp,c.differenceBy=up,c.differenceWith=hp,c.drop=lp,c.dropRight=pp,c.dropRightWhile=fp,c.dropWhile=dp,c.fill=gp,c.filter=_f,c.flatMap=If,c.flatMapDeep=Ef,c.flatMapDepth=bf,c.flatten=wo,c.flattenDeep=vp,c.flattenDepth=mp,c.flip=zf,c.flow=Mg,c.flowRight=Vg,c.fromPairs=_p,c.functions=Vd,c.functionsIn=Ud,c.groupBy=Pf,c.initial=wp,c.intersection=Ip,c.intersectionBy=Ep,c.intersectionWith=bp,c.invert=Ld,c.invertBy=zd,c.invokeMap=Cf,c.iteratee=Qn,c.keyBy=Rf,c.keys=ct,c.keysIn=It,c.map=yi,c.mapKeys=Hd,c.mapValues=Gd,c.matches=Ug,c.matchesProperty=kg,c.memoize=Ii,c.merge=Wd,c.mergeWith=zo,c.method=Lg,c.methodOf=zg,c.mixin=Zn,c.negate=Ei,c.nthArg=Hg,c.omit=Bd,c.omitBy=Kd,c.once=Ff,c.orderBy=Nf,c.over=Gg,c.overArgs=Hf,c.overEvery=Wg,c.overSome=Bg,c.partial=Hn,c.partialRight=xo,c.partition=Af,c.pick=Jd,c.pickBy=Fo,c.property=Yo,c.propertyOf=Kg,c.pull=Rp,c.pullAll=Eo,c.pullAllBy=Np,c.pullAllWith=Ap,c.pullAt=Op,c.range=Jg,c.rangeRight=Yg,c.rearg=Gf,c.reject=qf,c.remove=Dp,c.rest=Wf,c.reverse=Ln,c.sampleSize=$f,c.set=Qd,c.setWith=Zd,c.shuffle=jf,c.slice=qp,c.sortBy=Vf,c.sortedUniq=Up,c.sortedUniqBy=kp,c.split=Ig,c.spread=Bf,c.tail=Lp,c.take=zp,c.takeRight=Fp,c.takeRightWhile=Hp,c.takeWhile=Gp,c.tap=of,c.throttle=Kf,c.thru=_i,c.toArray=Vo,c.toPairs=Ho,c.toPairsIn=Go,c.toPath=ev,c.toPlainObject=ko,c.transform=Xd,c.unary=Jf,c.union=Wp,c.unionBy=Bp,c.unionWith=Kp,c.uniq=Jp,c.uniqBy=Yp,c.uniqWith=Qp,c.unset=tg,c.unzip=zn,c.unzipWith=bo,c.update=eg,c.updateWith=rg,c.values=Xe,c.valuesIn=ig,c.without=Zp,c.words=Ko,c.wrap=Yf,c.xor=Xp,c.xorBy=tf,c.xorWith=ef,c.zip=rf,c.zipObject=nf,c.zipObjectDeep=sf,c.zipWith=af,c.entries=Ho,c.entriesIn=Go,c.extend=Lo,c.extendWith=Si,Zn(c,c),c.add=iv,c.attempt=Jo,c.camelCase=og,c.capitalize=Wo,c.ceil=nv,c.clamp=ng,c.clone=Zf,c.cloneDeep=td,c.cloneDeepWith=ed,c.cloneWith=Xf,c.conformsTo=rd,c.deburr=Bo,c.defaultTo=Tg,c.divide=sv,c.endsWith=cg,c.eq=Gt,c.escape=ug,c.escapeRegExp=hg,c.every=mf,c.find=yf,c.findIndex=_o,c.findKey=qd,c.findLast=wf,c.findLastIndex=yo,c.findLastKey=xd,c.floor=av,c.forEach=So,c.forEachRight=Co,c.forIn=$d,c.forInRight=jd,c.forOwn=Td,c.forOwnRight=Md,c.get=Bn,c.gt=id,c.gte=nd,c.has=kd,c.hasIn=Kn,c.head=Io,c.identity=Et,c.includes=Sf,c.indexOf=yp,c.inRange=sg,c.invoke=Fd,c.isArguments=De,c.isArray=x,c.isArrayBuffer=sd,c.isArrayLike=wt,c.isArrayLikeObject=et,c.isBoolean=ad,c.isBuffer=we,c.isDate=od,c.isElement=cd,c.isEmpty=ud,c.isEqual=hd,c.isEqualWith=ld,c.isError=Gn,c.isFinite=pd,c.isFunction=ce,c.isInteger=$o,c.isLength=bi,c.isMap=jo,c.isMatch=fd,c.isMatchWith=dd,c.isNaN=gd,c.isNative=vd,c.isNil=_d,c.isNull=md,c.isNumber=To,c.isObject=Z,c.isObjectLike=X,c.isPlainObject=Pr,c.isRegExp=Wn,c.isSafeInteger=yd,c.isSet=Mo,c.isString=Pi,c.isSymbol=Rt,c.isTypedArray=Ze,c.isUndefined=wd,c.isWeakMap=Id,c.isWeakSet=Ed,c.join=Pp,c.kebabCase=lg,c.last=Mt,c.lastIndexOf=Sp,c.lowerCase=pg,c.lowerFirst=fg,c.lt=bd,c.lte=Pd,c.max=ov,c.maxBy=cv,c.mean=uv,c.meanBy=hv,c.min=lv,c.minBy=pv,c.stubArray=ts,c.stubFalse=es,c.stubObject=Qg,c.stubString=Zg,c.stubTrue=Xg,c.multiply=fv,c.nth=Cp,c.noConflict=Fg,c.noop=Xn,c.now=wi,c.pad=dg,c.padEnd=gg,c.padStart=vg,c.parseInt=mg,c.random=ag,c.reduce=Of,c.reduceRight=Df,c.repeat=_g,c.replace=yg,c.result=Yd,c.round=dv,c.runInContext=f,c.sample=xf,c.size=Tf,c.snakeCase=wg,c.some=Mf,c.sortedIndex=xp,c.sortedIndexBy=$p,c.sortedIndexOf=jp,c.sortedLastIndex=Tp,c.sortedLastIndexBy=Mp,c.sortedLastIndexOf=Vp,c.startCase=Eg,c.startsWith=bg,c.subtract=gv,c.sum=vv,c.sumBy=mv,c.template=Pg,c.times=tv,c.toFinite=ue,c.toInteger=$,c.toLength=Uo,c.toLower=Sg,c.toNumber=Vt,c.toSafeInteger=Sd,c.toString=z,c.toUpper=Cg,c.trim=Rg,c.trimEnd=Ng,c.trimStart=Ag,c.truncate=Og,c.unescape=Dg,c.uniqueId=rv,c.upperCase=qg,c.upperFirst=Jn,c.each=So,c.eachRight=Co,c.first=Io,Zn(c,function(){var t={};return Yt(c,function(e,r){H.call(c.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),c.VERSION=a,qt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){c[t].placeholder=c}),qt(["drop","take"],function(t,e){U.prototype[t]=function(r){r=r===i?1:at($(r),0);var n=this.__filtered__&&!e?new U(this):this.clone();return n.__filtered__?n.__takeCount__=dt(r,n.__takeCount__):n.__views__.push({size:dt(r,Jt),type:t+(n.__dir__<0?"Right":"")}),n},U.prototype[t+"Right"]=function(r){return this.reverse()[t](r).reverse()}}),qt(["filter","map","takeWhile"],function(t,e){var r=e+1,n=r==ys||r==Rc;U.prototype[t]=function(o){var u=this.clone();return u.__iteratees__.push({iteratee:A(o,3),type:r}),u.__filtered__=u.__filtered__||n,u}}),qt(["head","last"],function(t,e){var r="take"+(e?"Right":"");U.prototype[t]=function(){return this[r](1).value()[0]}}),qt(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");U.prototype[t]=function(){return this.__filtered__?new U(this):this[r](1)}}),U.prototype.compact=function(){return this.filter(Et)},U.prototype.find=function(t){return this.filter(t).head()},U.prototype.findLast=function(t){return this.reverse().find(t)},U.prototype.invokeMap=M(function(t,e){return typeof t=="function"?new U(this):this.map(function(r){return _r(r,t,e)})}),U.prototype.reject=function(t){return this.filter(Ei(A(t)))},U.prototype.slice=function(t,e){t=$(t);var r=this;return r.__filtered__&&(t>0||e<0)?new U(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==i&&(e=$(e),r=e<0?r.dropRight(-e):r.take(e-t)),r)},U.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},U.prototype.toArray=function(){return this.take(Jt)},Yt(U.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),o=c[n?"take"+(e=="last"?"Right":""):e],u=n||/^find/.test(e);o&&(c.prototype[e]=function(){var l=this.__wrapped__,p=n?[1]:arguments,d=l instanceof U,_=p[0],y=d||x(l),I=function(V){var k=o.apply(c,fe([V],p));return n&&P?k[0]:k};y&&r&&typeof _=="function"&&_.length!=1&&(d=y=!1);var P=this.__chain__,R=!!this.__actions__.length,O=u&&!P,j=d&&!R;if(!u&&y){l=j?l:new U(this);var D=t.apply(l,p);return D.__actions__.push({func:_i,args:[I],thisArg:i}),new $t(D,P)}return O&&j?t.apply(this,p):(D=this.thru(I),O?n?D.value()[0]:D.value():D)})}),qt(["pop","push","shift","sort","splice","unshift"],function(t){var e=Hr[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);c.prototype[t]=function(){var o=arguments;if(n&&!this.__chain__){var u=this.value();return e.apply(x(u)?u:[],o)}return this[r](function(l){return e.apply(x(l)?l:[],o)})}}),Yt(U.prototype,function(t,e){var r=c[e];if(r){var n=r.name+"";H.call(Be,n)||(Be[n]=[]),Be[n].push({name:e,func:r})}}),Be[li(i,Ot).name]=[{name:"wrapper",func:i}],U.prototype.clone=Oh,U.prototype.reverse=Dh,U.prototype.value=qh,c.prototype.at=cf,c.prototype.chain=uf,c.prototype.commit=hf,c.prototype.next=lf,c.prototype.plant=ff,c.prototype.reverse=df,c.prototype.toJSON=c.prototype.valueOf=c.prototype.value=gf,c.prototype.first=c.prototype.head,lr&&(c.prototype[lr]=pf),c},He=uh();be?((be.exports=He)._=He,Yi._=He):ht._=He}).call(Ar)})(ls,ls.exports);var v0=Object.defineProperty,m0=Object.defineProperties,_0=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,y0=Object.prototype.hasOwnProperty,w0=Object.prototype.propertyIsEnumerable,sc=(E,s,i)=>s in E?v0(E,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):E[s]=i,Ni=(E,s)=>{for(var i in s||(s={}))y0.call(s,i)&&sc(E,i,s[i]);if(nc)for(var i of nc(s))w0.call(s,i)&&sc(E,i,s[i]);return E},I0=(E,s)=>m0(E,_0(s));function kt(E,s,i){let a;const h=ps(E);return s.rpcMap&&(a=s.rpcMap[h]),a||(a=`${g0}?chainId=eip155:${h}&projectId=${i}`),a}function ps(E){return E.includes("eip155")?Number(E.split(":")[1]):Number(E)}function wc(E){return E.map(s=>`${s.split(":")[0]}:${s.split(":")[1]}`)}function E0(E,s){const i=Object.keys(s.namespaces).filter(h=>h.includes(E));if(!i.length)return[];const a=[];return i.forEach(h=>{const g=s.namespaces[h].accounts;a.push(...g)}),a}function b0(E={},s={}){const i=ac(E),a=ac(s);return ls.exports.merge(i,a)}function ac(E){var s,i,a,h;const g={};if(!Oi(E))return g;for(const[w,b]of Object.entries(E)){const S=dc(w)?[w]:b.chains,N=b.methods||[],F=b.events||[],Y=b.rpcMap||{},G=Di(w);g[G]=I0(Ni(Ni({},g[G]),b),{chains:ns(S,(s=g[G])==null?void 0:s.chains),methods:ns(N,(i=g[G])==null?void 0:i.methods),events:ns(F,(a=g[G])==null?void 0:a.events),rpcMap:Ni(Ni({},Y),(h=g[G])==null?void 0:h.rpcMap)})}return g}function P0(E){return E.includes(":")?E.split(":")[2]:E}function S0(E){const s={};for(const[i,a]of Object.entries(E)){const h=a.methods||[],g=a.events||[],w=a.accounts||[],b=dc(i)?[i]:a.chains?a.chains:wc(a.accounts);s[i]={chains:b,methods:h,events:g,accounts:w}}return s}const Ic={},it=E=>Ic[E],cs=(E,s)=>{Ic[E]=s};class C0{constructor(s){this.name="polkadot",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(this.chainId=s,!this.httpProviders[s]){const a=i||kt(`${this.name}:${s}`,this.namespace);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const s=this.namespace.accounts;return s?s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;s[i]=this.createHttpProvider(i,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||kt(s,this.namespace);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}class R0{constructor(s){this.name="eip155",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(s){switch(s.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(s);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(s.request.method)?await this.client.request(s):this.getHttpProvider().request(s.request)}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}setDefaultChain(s,i){const a=ps(s);if(!this.httpProviders[a]){const h=i||kt(`${this.name}:${a}`,this.namespace,this.client.core.projectId);if(!h)throw new Error(`No RPC url provided for chainId: ${a}`);this.setHttpProvider(a,h)}this.chainId=a,this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}createHttpProvider(s,i){const a=i||kt(`${this.name}:${s}`,this.namespace,this.client.core.projectId);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;const h=ps(i);s[h]=this.createHttpProvider(h,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const s=this.chainId,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}async handleSwitchChain(s){var i,a;let h=s.request.params?(i=s.request.params[0])==null?void 0:i.chainId:"0x0";h=h.startsWith("0x")?h:`0x${h}`;const g=parseInt(h,16);if(this.isChainApproved(g))this.setDefaultChain(`${g}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:s.topic,request:{method:s.request.method,params:[{chainId:h}]},chainId:(a=this.namespace.chains)==null?void 0:a[0]}),this.setDefaultChain(`${g}`);else throw new Error(`Failed to switch to chain 'eip155:${g}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(s){return this.namespace.chains.includes(`${this.name}:${s}`)}}class N0{constructor(s){this.name="solana",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(!this.httpProviders[s]){const a=i||kt(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;s[i]=this.createHttpProvider(i,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||kt(s,this.namespace,this.client.core.projectId);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}class A0{constructor(s){this.name="cosmos",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(this.chainId=s,!this.httpProviders[s]){const a=i||kt(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;s[i]=this.createHttpProvider(i,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||kt(s,this.namespace,this.client.core.projectId);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}class O0{constructor(s){this.name="cip34",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(this.chainId=s,!this.httpProviders[s]){const a=i||this.getCardanoRPCUrl(s);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{const a=this.getCardanoRPCUrl(i);s[i]=this.createHttpProvider(i,a)}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}getCardanoRPCUrl(s){const i=this.namespace.rpcMap;if(i)return i[s]}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||this.getCardanoRPCUrl(s);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}class D0{constructor(s){this.name="elrond",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(!this.httpProviders[s]){const a=i||kt(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;s[i]=this.createHttpProvider(i,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||kt(s,this.namespace,this.client.core.projectId);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}class q0{constructor(s){this.name="multiversx",this.namespace=s.namespace,this.events=it("events"),this.client=it("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(s){this.namespace=Object.assign(this.namespace,s)}requestAccounts(){return this.getAccounts()}request(s){return this.namespace.methods.includes(s.request.method)?this.client.request(s):this.getHttpProvider().request(s.request)}setDefaultChain(s,i){if(!this.httpProviders[s]){const a=i||kt(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ie.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const s=this.namespace.chains[0];if(!s)throw new Error("ChainId not found");return s.split(":")[1]}getAccounts(){const s=this.namespace.accounts;return s?[...new Set(s.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const s={};return this.namespace.chains.forEach(i=>{var a;s[i]=this.createHttpProvider(i,(a=this.namespace.rpcMap)==null?void 0:a[i])}),s}getHttpProvider(){const s=`${this.name}:${this.chainId}`,i=this.httpProviders[s];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${s} not found`);return i}setHttpProvider(s,i){const a=this.createHttpProvider(s,i);a&&(this.httpProviders[s]=a)}createHttpProvider(s,i){const a=i||kt(s,this.namespace,this.client.core.projectId);return typeof a>"u"?void 0:new je(new Te(a,it("disableProviderPing")))}}var x0=Object.defineProperty,$0=Object.defineProperties,j0=Object.getOwnPropertyDescriptors,oc=Object.getOwnPropertySymbols,T0=Object.prototype.hasOwnProperty,M0=Object.prototype.propertyIsEnumerable,cc=(E,s,i)=>s in E?x0(E,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):E[s]=i,Ai=(E,s)=>{for(var i in s||(s={}))T0.call(s,i)&&cc(E,i,s[i]);if(oc)for(var i of oc(s))M0.call(s,i)&&cc(E,i,s[i]);return E},us=(E,s)=>$0(E,j0(s));class ms{constructor(s){this.events=new fc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=s,this.logger=typeof s?.logger<"u"&&typeof s?.logger!="string"?s.logger:er.pino(er.getDefaultLoggerOptions({level:s?.logger||rc})),this.disableProviderPing=s?.disableProviderPing||!1}static async init(s){const i=new ms(s);return await i.initialize(),i}async request(s,i){const[a,h]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(a).request({request:Ai({},s),chainId:`${a}:${h}`,topic:this.session.topic})}sendAsync(s,i,a){this.request(s,a).then(h=>i(null,h)).catch(h=>i(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var s;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(s=this.session)==null?void 0:s.topic,reason:Xt("USER_DISCONNECTED")}),await this.cleanup()}async connect(s){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(s),await this.cleanupPendingPairings(),!s.skipPairing)return await this.pair(s.pairingTopic)}on(s,i){this.events.on(s,i)}once(s,i){this.events.once(s,i)}removeListener(s,i){this.events.removeListener(s,i)}off(s,i){this.events.off(s,i)}get isWalletConnect(){return!0}async pair(s){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:a,approval:h}=await this.client.connect({pairingTopic:s,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});a&&(this.uri=a,this.events.emit("display_uri",a)),await h().then(g=>{this.session=g,this.namespaces||(this.namespaces=S0(g.namespaces),this.persist("namespaces",this.namespaces))}).catch(g=>{if(g.message!==_c)throw g;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(s,i){try{if(!this.session)return;const[a,h]=this.validateChain(s);this.getProvider(a).setDefaultChain(h,i)}catch(a){if(!/Please call connect/.test(a.message))throw a}}async cleanupPendingPairings(s={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(Dr(i)){for(const a of i)s.deletePairings?this.client.core.expirer.set(a.topic,0):await this.client.core.relayer.subscriber.unsubscribe(a.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const s=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[s]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await l0.init({logger:this.providerOpts.logger||rc,relayUrl:this.providerOpts.relayUrl||p0,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const s=[...new Set(Object.keys(this.session.namespaces).map(i=>Di(i)))];cs("client",this.client),cs("events",this.events),cs("disableProviderPing",this.disableProviderPing),s.forEach(i=>{if(!this.session)return;const a=E0(i,this.session),h=wc(a),g=b0(this.namespaces,this.optionalNamespaces),w=us(Ai({},g[i]),{accounts:a,chains:h});switch(i){case"eip155":this.rpcProviders[i]=new R0({namespace:w});break;case"solana":this.rpcProviders[i]=new N0({namespace:w});break;case"cosmos":this.rpcProviders[i]=new A0({namespace:w});break;case"polkadot":this.rpcProviders[i]=new C0({namespace:w});break;case"cip34":this.rpcProviders[i]=new O0({namespace:w});break;case"elrond":this.rpcProviders[i]=new D0({namespace:w});break;case"multiversx":this.rpcProviders[i]=new q0({namespace:w});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",s=>{this.events.emit("session_ping",s)}),this.client.on("session_event",s=>{const{params:i}=s,{event:a}=i;if(a.name==="accountsChanged"){const h=a.data;h&&Dr(h)&&this.events.emit("accountsChanged",h.map(P0))}else a.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(a.name,a.data);this.events.emit("session_event",s)}),this.client.on("session_update",({topic:s,params:i})=>{var a;const{namespaces:h}=i,g=(a=this.client)==null?void 0:a.session.get(s);this.session=us(Ai({},g),{namespaces:h}),this.onSessionUpdate(),this.events.emit("session_update",{topic:s,params:i})}),this.client.on("session_delete",async s=>{await this.cleanup(),this.events.emit("session_delete",s),this.events.emit("disconnect",us(Ai({},Xt("USER_DISCONNECTED")),{data:s.topic}))}),this.on(Ie.DEFAULT_CHAIN_CHANGED,s=>{this.onChainChanged(s,!0)})}getProvider(s){if(!this.rpcProviders[s])throw new Error(`Provider not found: ${s}`);return this.rpcProviders[s]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(s=>{var i;this.getProvider(s).updateNamespace((i=this.session)==null?void 0:i.namespaces[s])})}setNamespaces(s){const{namespaces:i,optionalNamespaces:a,sessionProperties:h}=s;i&&Object.keys(i).length&&(this.namespaces=i),a&&Object.keys(a).length&&(this.optionalNamespaces=a),this.sessionProperties=h,this.persist("namespaces",i),this.persist("optionalNamespaces",a)}validateChain(s){const[i,a]=s?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,a];if(i&&!Object.keys(this.namespaces||{}).map(w=>Di(w)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&a)return[i,a];const h=Di(Object.keys(this.namespaces)[0]),g=this.rpcProviders[h].getDefaultChain();return[h,g]}async requestAccounts(){const[s]=this.validateChain();return await this.getProvider(s).requestAccounts()}onChainChanged(s,i=!1){var a;if(!this.namespaces)return;const[h,g]=this.validateChain(s);i||this.getProvider(h).setDefaultChain(g),((a=this.namespaces[h])!=null?a:this.namespaces[`${h}:${g}`]).defaultChain=g,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",g)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(s,i){this.client.core.storage.setItem(`${ic}/${s}`,i)}async getFromStore(s){return await this.client.core.storage.getItem(`${ic}/${s}`)}}const V0=ms,U0="wc",k0="ethereum_provider",L0=`${U0}@2:${k0}:`,z0="https://rpc.walletconnect.com/v1/",fs=["eth_sendTransaction","personal_sign"],F0=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ds=["chainChanged","accountsChanged"],H0=["message","disconnect","connect"];var G0=Object.defineProperty,W0=Object.defineProperties,B0=Object.getOwnPropertyDescriptors,uc=Object.getOwnPropertySymbols,K0=Object.prototype.hasOwnProperty,J0=Object.prototype.propertyIsEnumerable,hc=(E,s,i)=>s in E?G0(E,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):E[s]=i,Or=(E,s)=>{for(var i in s||(s={}))K0.call(s,i)&&hc(E,i,s[i]);if(uc)for(var i of uc(s))J0.call(s,i)&&hc(E,i,s[i]);return E},lc=(E,s)=>W0(E,B0(s));function qi(E){return Number(E[0].split(":")[1])}function hs(E){return`0x${E.toString(16)}`}function Y0(E){const{chains:s,optionalChains:i,methods:a,optionalMethods:h,events:g,optionalEvents:w,rpcMap:b}=E;if(!Dr(s))throw new Error("Invalid chains");const S={chains:s,methods:a||fs,events:g||ds,rpcMap:Or({},s.length?{[qi(s)]:b[qi(s)]}:{})},N=g?.filter(Q=>!ds.includes(Q)),F=a?.filter(Q=>!fs.includes(Q));if(!i&&!w&&!h&&!(N!=null&&N.length)&&!(F!=null&&F.length))return{required:s.length?S:void 0};const Y=N?.length&&F?.length||!i,G={chains:[...new Set(Y?S.chains.concat(i||[]):i)],methods:[...new Set(S.methods.concat(h!=null&&h.length?h:F0))],events:[...new Set(S.events.concat(w||H0))],rpcMap:b};return{required:s.length?S:void 0,optional:i.length?G:void 0}}class _s{constructor(){this.events=new pc.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=L0,this.on=(s,i)=>(this.events.on(s,i),this),this.once=(s,i)=>(this.events.once(s,i),this),this.removeListener=(s,i)=>(this.events.removeListener(s,i),this),this.off=(s,i)=>(this.events.off(s,i),this),this.parseAccount=s=>this.isCompatibleChainId(s)?this.parseAccountId(s).address:s,this.signer={},this.rpc={}}static async init(s){const i=new _s;return await i.initialize(s),i}async request(s){return await this.signer.request(s,this.formatChainId(this.chainId))}sendAsync(s,i){this.signer.sendAsync(s,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(s){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(s);const{required:i,optional:a}=Y0(this.rpc);try{const h=await new Promise(async(w,b)=>{var S;this.rpc.showQrModal&&((S=this.modal)==null||S.subscribeModal(N=>{!N.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),b(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(lc(Or({namespaces:Or({},i&&{[this.namespace]:i})},a&&{optionalNamespaces:{[this.namespace]:a}}),{pairingTopic:s?.pairingTopic})).then(N=>{w(N)}).catch(N=>{b(new Error(N.message))})});if(!h)return;this.setChainIds(this.rpc.chains);const g=Mv(h.namespaces,[this.namespace]);this.setAccounts(g),this.events.emit("connect",{chainId:hs(this.chainId)})}catch(h){throw this.signer.logger.error(h),h}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",s=>{const{params:i}=s,{event:a}=i;a.name==="accountsChanged"?(this.accounts=this.parseAccounts(a.data),this.events.emit("accountsChanged",this.accounts)):a.name==="chainChanged"?this.setChainId(this.formatChainId(a.data)):this.events.emit(a.name,a.data),this.events.emit("session_event",s)}),this.signer.on("chainChanged",s=>{const i=parseInt(s);this.chainId=i,this.events.emit("chainChanged",hs(this.chainId)),this.persist()}),this.signer.on("session_update",s=>{this.events.emit("session_update",s)}),this.signer.on("session_delete",s=>{this.reset(),this.events.emit("session_delete",s),this.events.emit("disconnect",lc(Or({},Xt("USER_DISCONNECTED")),{data:s.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",s=>{var i,a;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(a=this.modal)==null||a.openModal({uri:s})),this.events.emit("display_uri",s)})}switchEthereumChain(s){this.request({method:"wallet_switchEthereumChain",params:[{chainId:s.toString(16)}]})}isCompatibleChainId(s){return typeof s=="string"?s.startsWith(`${this.namespace}:`):!1}formatChainId(s){return`${this.namespace}:${s}`}parseChainId(s){return Number(s.split(":")[1])}setChainIds(s){const i=s.filter(a=>this.isCompatibleChainId(a)).map(a=>this.parseChainId(a));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",hs(this.chainId)),this.persist())}setChainId(s){if(this.isCompatibleChainId(s)){const i=this.parseChainId(s);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(s){const[i,a,h]=s.split(":");return{chainId:`${i}:${a}`,address:h}}setAccounts(s){this.accounts=s.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(s){var i,a;const h=(i=s?.chains)!=null?i:[],g=(a=s?.optionalChains)!=null?a:[],w=h.concat(g);if(!w.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const b=h.length?s?.methods||fs:[],S=h.length?s?.events||ds:[],N=s?.optionalMethods||[],F=s?.optionalEvents||[],Y=s?.rpcMap||this.buildRpcMap(w,s.projectId),G=s?.qrModalOptions||void 0;return{chains:h?.map(Q=>this.formatChainId(Q)),optionalChains:g.map(Q=>this.formatChainId(Q)),methods:b,events:S,optionalMethods:N,optionalEvents:F,rpcMap:Y,showQrModal:!!(s!=null&&s.showQrModal),qrModalOptions:G,projectId:s.projectId,metadata:s.metadata}}buildRpcMap(s,i){const a={};return s.forEach(h=>{a[h]=this.getRpcUrl(h,i)}),a}async initialize(s){if(this.rpc=this.getRpcConfig(s),this.chainId=this.rpc.chains.length?qi(this.rpc.chains):qi(this.rpc.optionalChains),this.signer=await V0.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:s.disableProviderPing,relayUrl:s.relayUrl,storageOptions:s.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:a}=await Vv(()=>import("./index-02f7e828.js").then(h=>h.a),["./index-02f7e828.js","./main-1e616d6f.js","./tiptap-313d156f.js","./osx-ethers-780b73f3.js","./index-c27b60be.css"],import.meta.url);i=a}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Or({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(a){throw this.signer.logger.error(a),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(s){if(!s)return;const{chains:i,optionalChains:a,rpcMap:h}=s;i&&Dr(i)&&(this.rpc.chains=i.map(g=>this.formatChainId(g)),i.forEach(g=>{this.rpc.rpcMap[g]=h?.[g]||this.getRpcUrl(g)})),a&&Dr(a)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=a?.map(g=>this.formatChainId(g)),a.forEach(g=>{this.rpc.rpcMap[g]=h?.[g]||this.getRpcUrl(g)}))}getRpcUrl(s,i){var a;return((a=this.rpc.rpcMap)==null?void 0:a[s])||`${z0}?chainId=eip155:${s}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const s=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${s}`]?this.session.namespaces[`${this.namespace}:${s}`]:this.session.namespaces[this.namespace];this.setChainIds(s?[this.formatChainId(s)]:i?.accounts),this.setAccounts(i?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(s){return typeof s=="string"||s instanceof String?[this.parseAccount(s)]:s.map(i=>this.parseAccount(i))}}const im=_s;export{im as EthereumProvider,H0 as OPTIONAL_EVENTS,F0 as OPTIONAL_METHODS,ds as REQUIRED_EVENTS,fs as REQUIRED_METHODS,_s as default};
