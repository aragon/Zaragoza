import{y as k,u as M,h as z,q as e,Q as U,v as J,dx as Y,aJ as P,dy as X,w as R,cv as Z,al as G,e as O,j as F,G as H,ap as ee,ar as B,A as $,z as q,x as se,as as _,t as te,I as le,dz as V}from"./main-1e616d6f.js";import{r as x}from"./tiptap-313d156f.js";import{b as K,c as ae}from"./accordionSummary-a06aa21e.js";import{F as w,b as ne,M as re,g as oe}from"./index-4cbd21fe.js";const ie=({addWalletCallback:o,wallets:u,initialSelections:A})=>{const{t:r}=M(),{isOpen:p,close:s}=z("manageWallet"),[j,f]=x.useState(""),[i,b]=x.useState(new Set),n=i.size,C=n===u.length,d=x.useMemo(()=>{if(j!==""){const t=new RegExp(j,"i");return u.filter(l=>l.match(t))}return u},[j,u]),g=x.useMemo(()=>n===0?{button:r("labels.selectWallets"),label:r("labels.noAddressSelected")}:n===1?{button:r("labels.addSingleWallet"),label:r("labels.singleAddressSelected")}:{button:r("labels.addNWallets",{walletCount:n}),label:r("labels.nAddressesSelected",{walletCount:n})},[n,r]);x.useEffect(()=>{A&&b(new Set(A))},[A]);const v=()=>{b(C?new Set:t=>{const l=new Set(t);return u.forEach(c=>{l.add(c)}),l})},S=t=>{b(l=>{const c=new Set(l);return l.has(t)?c.delete(t):c.add(t),c})},h=()=>{f(""),b(new Set),s()};return e.jsxs(U,{isOpen:p,onClose:h,"data-testid":"manageWalletModal",children:[e.jsx(de,{children:e.jsx(J,{value:j,placeholder:r("placeHolders.searchTokens"),onChange:t=>f(t.target.value)})}),e.jsxs(ce,{children:[e.jsxs(me,{children:[e.jsx("p",{className:"text-neutral-400",children:g.label}),e.jsx(Y,{label:"Select All",multiSelect:!0,iconLeft:!1,state:C?"active":"default",onClick:v})]}),e.jsx("div",{className:"space-y-3",children:d.map(t=>e.jsx(P,{label:X(t),multiSelect:!0,type:i.has(t)?"active":"default",onClick:()=>S(t)},t))})]}),e.jsxs(ue,{children:[e.jsx(R,{size:"lg",variant:"primary",onClick:()=>{o(Array.from(i)),h()},children:g.button}),e.jsx(R,{variant:"tertiary",size:"lg",onClick:h,children:r("labels.cancel")})]})]})},de=k.div.attrs({className:"p-6 bg-neutral-0 rounded-xl sticky top-0"})`
  box-shadow:
    0px 4px 8px rgba(31, 41, 51, 0.04),
    0px 0px 2px rgba(31, 41, 51, 0.06),
    0px 0px 1px rgba(31, 41, 51, 0.04);
`,ce=k.div.attrs({className:"p-6 max-h-96 overflow-auto"})``,me=k.div.attrs({className:"flex justify-between items-center mb-5 mr-[18px]"})``,ue=k.div.attrs({className:"flex py-4 px-6 space-x-4 bg-neutral-0"})``,ge=({actionIndex:o,useCustomHeader:u=!1,currentDaoMembers:A,allowRemove:r=!0,borderless:p})=>{const{t:s}=M(),{open:j}=z(),{removeAction:f}=Z(),{alert:i}=G(),{network:b}=O(),{data:n}=F(),{control:C,setValue:d}=H(),g=`actions.${o}.inputs.memberWallets`,{fields:v,replace:S,remove:h}=ee({control:C,name:g}),t=B({name:g,control:C}),l=v.map((a,N)=>({...a,...t&&{...t[N]}}));x.useEffect(()=>{d(`actions.${o}.name`,"remove_address")},[]);const c=a=>{S(a.map(N=>({address:N})))};function D(a){h(a)}function I(){S([]),i(s("alert.chip.removedAllAddresses"))}function m(){S([]),i(s("alert.chip.resetAction"))}const W=[{label:s("labels.whitelistWallets.deleteEntry"),callback:a=>{D(a),i(s("alert.chip.removedAddress"))}}],y=(()=>{const a=[e.jsx($.Item,{onClick:m,disabled:t?.length===0,children:s("labels.resetAction")},0)];return r&&a.push(e.jsx($.Item,{onClick:()=>{f(o),i(s("alert.chip.removedAction"))},children:s("labels.removeEntireAction")},1)),a})();return e.jsxs(K,{verified:!0,type:"action-builder",methodName:s("labels.removeWallets"),smartContractName:`Multisig v${n?.plugins[0].release}.${n?.plugins[0].build}`,smartContractAddress:n?.plugins[0].instanceAddress,blockExplorerLink:n?.plugins[0].instanceAddress?`${q[b].explorer}address/${n?.plugins[0].instanceAddress}`:void 0,methodDescription:s("labels.removeWalletsDescription"),dropdownItems:y,customHeader:u&&e.jsx(pe,{}),children:[!t||t.length===0?e.jsx(w,{className:`flex justify-center py-6 ${u?"rounded-xl border-t":"rounded-b-xl"}`,hideBorder:p,children:e.jsx(se,{objectIllustration:{object:"WALLET"},heading:s("labels.whitelistWallets.noWallets"),secondaryButton:{label:s("labels.selectWallet"),onClick:()=>j("manageWallet")}})}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:`hidden xl:block ${u?"rounded-t-xl border-t pb-3 pt-6":"py-3"}`,hideBorder:p,children:e.jsx(_,{label:s("labels.whitelistWallets.address")})}),l.map((a,N)=>e.jsxs(w,{className:`${N===0&&"rounded-t-xl border-t xl:rounded-[0px] xl:border-t-0"}`,hideBorder:p,children:[e.jsx("div",{className:"mb-1 xl:mb-0 xl:hidden",children:e.jsx(_,{label:s("labels.whitelistWallets.address")})}),e.jsx(ne,{isRemove:!0,actionIndex:o,fieldIndex:N,dropdownItems:W},a.id)]},a.id)),e.jsxs(w,{className:"flex justify-between",hideBorder:p,children:[e.jsx(R,{variant:"tertiary",size:"lg",onClick:()=>j("manageWallet"),children:s("labels.selectWallet")}),e.jsx($.Container,{align:"start",customTrigger:e.jsx(R,{size:"lg",variant:"tertiary",iconLeft:te.DOTS_VERTICAL,"data-testid":"trigger"}),children:e.jsx($.Item,{onClick:I,children:s("labels.whitelistWallets.deleteAllEntries")})})]}),e.jsx(ae,{total:l.length})]}),e.jsx(ie,{addWalletCallback:c,wallets:A?.map(a=>a.address)||[],initialSelections:l.map(a=>a.address)})]})},pe=()=>{const{t:o}=M();return e.jsxs("div",{className:"mb-3 space-y-1",children:[e.jsx("p",{className:"text-base font-semibold leading-normal text-neutral-800",children:o("labels.removeWallets")}),e.jsx("p",{className:"text-sm leading-normal text-neutral-600",children:o("labels.removeWalletsDescription")})]})},ve=({actionIndex:o,useCustomHeader:u=!1,currentDaoMembers:A,currentMinimumApproval:r,isGasless:p=!1})=>{const{t:s}=M(),{network:j}=O(),{data:f}=F(),{setValue:i,control:b,trigger:n,getValues:C}=H(),d=p?"committeeMinimumApproval":`actions.${o}.inputs.minApprovals`,g=B({name:d,defaultValue:r,control:b}),[v,S]=x.useState(-1),[h,t]=x.useState(-1),l=v>=0||h>=0||A&&A.length>0?(A?.length||0)+(v-h):0,c=B({name:"actions",control:b});x.useEffect(()=>{r&&!g&&i(d,r)},[r,d,g,i]),x.useEffect(()=>{if(c&&c.length>0){const m=c.map(E=>E.name).indexOf("add_address"),W=c.map(E=>E.name).indexOf("remove_address"),[y,a]=C([`actions.${m}.inputs.memberWallets`,`actions.${W}.inputs.memberWallets`]),N=y?.filter(E=>E?.address!=="").length||0,Q=a?.length||0;S(N),t(Q)}},[c,C]),x.useEffect(()=>{p||i(`actions.${o}.name`,"modify_multisig_voting_settings")},[]),x.useEffect(()=>{(h!==-1||v!==-1)&&n(d)},[v,d,h,l,n]);const D=m=>{if(l===0)return s("errors.minimumApproval.membersRequired");if(m<1)return s("errors.minimumApproval.lessThanOne");if(m>l)return s("errors.minimumApproval.exceedMaxThreshold")},I=(m,W)=>{const y=Number(m.target.value);W(m),y<1?setTimeout(()=>{i(d,1),n(d)},V):y>l&&setTimeout(()=>{i(d,l),n(d)},V)};return e.jsxs(K,{verified:!0,type:"action-builder",methodName:s("labels.minimumApproval"),smartContractName:`Multisig v${f?.plugins[0].release}.${f?.plugins[0].build}`,smartContractAddress:f?.plugins[0].instanceAddress,blockExplorerLink:f?.plugins[0].instanceAddress?`${q[j].explorer}address/${f?.plugins[0].instanceAddress}`:void 0,customHeader:u&&e.jsx(xe,{}),methodDescription:s("labels.minimumApprovalDescription"),additionalInfo:s("labels.minimumApprovalAdditionalInfo"),children:[u&&e.jsx(w,{className:"rounded-t-xl border-t pb-3 pt-6 xl:block",hideBorder:p,children:e.jsx(_,{label:s("labels.approvals")})}),e.jsx(w,{hideBorder:p,children:e.jsx(le,{name:d,defaultValue:g,control:b,rules:{required:s("errors.minimumApproval.required"),validate:m=>D(m)},render:({field:{onChange:m,value:W},fieldState:{error:y}})=>e.jsx(re,{disabled:l===0,min:1,max:l,value:W,onChange:a=>I(a,m),error:oe(W,l,s,y)})})}),e.jsxs(be,{className:p?"border-0":"",children:[e.jsx("p",{className:"font-semibold text-neutral-800",children:s("labels.summary")}),e.jsxs(T,{children:[e.jsx(L,{children:s("labels.addedMembers")}),e.jsx("p",{children:v})]}),e.jsxs(T,{children:[e.jsx(L,{children:s("labels.removedMembers")}),e.jsx("p",{children:h})]}),e.jsxs(T,{children:[e.jsx(L,{children:s("labels.totalMembers")}),e.jsx("p",{children:l})]})]})]})},xe=()=>{const{t:o}=M();return e.jsxs("div",{className:"mb-3 space-y-1",children:[e.jsx("p",{className:"text-base font-semibold leading-normal text-neutral-800",children:o("labels.minimumApproval")}),e.jsx("p",{className:"text-sm leading-normal text-neutral-600",children:o("labels.minimumApprovalDescription")})]})},be=k.div.attrs({className:"p-4 md:p-6 space-y-3 font-semibold text-neutral-800 border border-neutral-100 rounded-b-xl border-t-0 bg-neutral-0"})``,T=k.div.attrs({className:"flex justify-between"})``,L=k.p.attrs({className:"font-normal text-neutral-500"})``;export{ge as R,ve as U};
