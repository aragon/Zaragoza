import{u as k,e as b,Y as D,cv as P,G as S,aM as C,ar as B,q as t,R as F,b9 as N,cz as z,cy as L,F as l,cw as g,j as $,bJ as v,aL as y,L as V,aN as E,ct as M}from"./main-1e616d6f.js";import{r as U}from"./tiptap-313d156f.js";import{i as R,D as q,C as G}from"./createProposal-e1ca110a.js";import{F as J}from"./index-5413d03b.js";import{S as c,i as O,a as Q}from"./index-9717678c.js";import{C as Y}from"./index-5cc856d8.js";import{R as H}from"./index-b5e6cc73.js";import"./osx-ethers-780b73f3.js";import"./index-b80a0dc5.js";import"./useTokenSupply-9a8f8b12.js";import"./query-keys-5b13e665.js";import"./useTokenMetadata-6398f62d.js";import"./index.es-c80844a1.js";import"./browser-9096de8d.js";import"./index-4cbd21fe.js";import"./accordionSummary-a06aa21e.js";import"./index-30af19f4.js";import"./index-93139e2c.js";import"./useResolveDaoAvatar-b536da94.js";import"./button-023419f0.js";const K=({enableTxModal:p,daoDetails:i,pluginSettings:a})=>{const{t:e}=k(),{network:r}=b(),{address:u}=D(),{actions:n,addAction:x}=P(),{control:m,getValues:s}=S(),{errors:w,dirtyFields:f}=C({control:m}),_=B({name:"actions",control:m});return t.jsx(t.Fragment,{children:t.jsxs(J,{wizardProcessName:e("TransferModal.item2Title"),navLabel:e("allTransfer.newTransfer"),processType:"ProposalCreation",returnPath:F(z,{network:r,dao:N(i?.ensDomain)||i?.address}),children:[t.jsx(c,{wizardTitle:e("newWithdraw.configureWithdraw.title"),wizardDescription:e("newWithdraw.configureWithdraw.subtitle"),isNextButtonDisabled:!n.length||!L(_,n,w,r),onNextButtonClicked:o=>{l("newWithdraw_continueBtn_clicked",{step:"1_configure_withdraw",settings:n.map((h,d)=>({to:s(`actions.${d}.to`),token_address:s(`actions.${d}.tokenAddress`),amount:s(`actions.${d}.amount`)}))}),o()},children:t.jsx(Y,{label:"",initialActions:["withdraw_assets"],whitelistedActions:["withdraw_assets"],addExtraActionLabel:e("newWithdraw.configureWithdraw.ctaAddAnother"),onAddExtraActionClick:()=>{x({name:"withdraw_assets"}),l("newWithdraw_addAnother_clicked",{dao_address:i.address})},hideAlert:!0,allowEmpty:!1})}),t.jsx(c,{wizardTitle:e("newWithdraw.setupVoting.title"),wizardDescription:e("newWithdraw.setupVoting.description"),isNextButtonDisabled:!O(w),onNextButtonClicked:o=>{const[h,d,W,T,j,A]=s(["startDate","startTime","startUtc","endDate","endTime","endUtc"]);l("newWithdraw_continueBtn_clicked",{step:"2_setup_voting",settings:{start:`${h}T${d}:00${g(W)}`,end:`${T}T${j}:00${g(A)}`}}),o()},children:t.jsx(Q,{pluginSettings:a})}),t.jsx(c,{wizardTitle:e("newWithdraw.defineProposal.heading"),wizardDescription:e("newWithdraw.defineProposal.description"),isNextButtonDisabled:!R(f,w),onNextButtonClicked:o=>{l("newWithdraw_continueBtn_clicked",{step:"3_define_proposal",settings:{author_address:u,title:s("proposalTitle"),summary:s("proposalSummary"),proposal:s("proposal"),resources_list:s("links")}}),o()},children:t.jsx(q,{})}),t.jsx(c,{wizardTitle:e("newWithdraw.reviewProposal.heading"),wizardDescription:e("newWithdraw.reviewProposal.description"),nextButtonLabel:e("labels.submitProposal"),onNextButtonClicked:()=>{l("newWithdraw_publishBtn_clicked",{dao_address:i?.address}),p()},fullWidth:!0,children:t.jsx(H,{defineProposalStepNumber:3})})]})})},X={links:[{name:"",url:""}],startSwitch:"now",durationSwitch:"duration",actions:[]},ft=()=>{const[p,i]=U.useState(!1),{data:a,isLoading:e}=$(),{data:r,isLoading:u}=v({pluginAddress:a?.plugins[0].instanceAddress,pluginType:a?.plugins[0].id}),n=y({defaultValues:X,mode:"onChange"});return e||u?t.jsx(V,{}):!a||!r?null:t.jsx(t.Fragment,{children:t.jsx(E,{...n,children:t.jsx(M,{daoId:a.address,children:t.jsx(G,{showTxModal:p,setShowTxModal:i,children:t.jsx(K,{daoDetails:a,pluginSettings:r,enableTxModal:()=>i(!0)})})})})})};export{ft as NewWithdraw};
